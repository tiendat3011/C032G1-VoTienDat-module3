if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("LiveVideoViewerTypedLogger",["Banzai","GeneratedLoggerUtils"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:LiveVideoViewerLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:LiveVideoViewerLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:LiveVideoViewerLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setCommentID=function(a){this.$1.comment_id=a;return this};c.setCommentLocation=function(a){this.$1.comment_location=a;return this};c.setCommentReplyThreadLength=function(a){this.$1.comment_reply_thread_length=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setIsCommentBeforeUserJoined=function(a){this.$1.is_comment_before_user_joined=a;return this};c.setNumHistoricalCommentsLoaded=function(a){this.$1.num_historical_comments_loaded=a;return this};c.setReplyThreadDurationMs=function(a){this.$1.reply_thread_duration_ms=a;return this};c.setTargetID=function(a){this.$1.target_id=a;return this};return a}();c={comment_id:!0,comment_location:!0,comment_reply_thread_length:!0,event:!0,is_comment_before_user_joined:!0,num_historical_comments_loaded:!0,reply_thread_duration_ms:!0,target_id:!0};f["default"]=a}),66);
__d("UFICommentTypedLogger",["Banzai","GeneratedLoggerUtils"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:UFICommentLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:UFICommentLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:UFICommentLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setDuration=function(a){this.$1.duration=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setHasPhoto=function(a){this.$1.has_photo=a;return this};c.setHasSticker=function(a){this.$1.has_sticker=a;return this};c.setIsReply=function(a){this.$1.is_reply=a;return this};c.setRequestLength=function(a){this.$1.request_length=a;return this};return a}();c={duration:!0,event:!0,has_photo:!0,has_sticker:!0,is_reply:!0,request_length:!0};f["default"]=a}),66);
__d("UFICommentLogger",["UFICommentTypedLogger"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1={},this.$2={}}var b=a.prototype;b.logNewCommentPost=function(a,b,d){this.$2[a]=babelHelpers["extends"]({timestamp:b},d),new(c("UFICommentTypedLogger"))().setEvent("new_comment_post").setHasPhoto(d.has_photo).setHasSticker(d.has_sticker).setIsReply(d.is_reply).log()};b.logNewCommentReceived=function(a,b){var d=this.$2[a];if(d){var e=0;b&&d.timestamp&&(e=b-d.timestamp);new(c("UFICommentTypedLogger"))().setEvent("new_comment_received").setDuration(e).setHasPhoto(d.has_photo).setHasSticker(d.has_sticker).setIsReply(d.is_reply).log()}delete this.$2[a]};b.logCommentFetch=function(a,b,d){b=babelHelpers["extends"]({timestamp:b},d);this.$1[a]===void 0?this.$1[a]=[b]:this.$1[a].push(b);new(c("UFICommentTypedLogger"))().setEvent("fetch_comment").setIsReply(d.is_reply).setRequestLength(d.request_length).log()};b.logCommentFetchReceived=function(a,b){if(this.$1[a]){var d=this.$1[a].shift(),e=0;b&&d.timestamp&&(e=b-d.timestamp);new(c("UFICommentTypedLogger"))().setEvent("fetch_comment_received").setDuration(e).setIsReply(d.is_reply).setRequestLength(d.request_length).log();this.$1[a].length===0&&delete this.$1[a]}};return a}();b=new a();g["default"]=b}),98);
__d("UFIAddCommentActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({CANCEL:"add_comment_cancel",CHANGE_CONTENT:"add_comment_change_content",RETRY_SUBMIT:"add_comment_retry_submit",SUBMIT_EDIT:"add_comment_submit_edit",SUBMIT_NEW:"add_comment_submit_new",PIVOT_SEND_MESSAGE:"pivot_send_message"});f["default"]=a}),66);
__d("UFIInstanceActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({CHANGE_ORDER_MODE:"story_change_order_mode",CHANGE_VISIBILITY:"story_change_visibility",INIT:"instance_init",RECEIVED_VOD_COMMENTS:"received_vod_comments",REMOVE:"story_remove",REQUESTED_VOD_COMMENTS:"requested_vod_comments",TOGGLE_AUTO_TRANSLATE_COMMENTS:"toggle_auto_translate_comments",TOGGLE_COMMENTS:"story_toggle_comments",TOGGLE_COMMERCIAL_BREAK:"story_toggle_commercial_break",TRANSLATE_ALL:"translate_all",FOUND_VIDEO_PLAYER_CONTROLLER:"found_video_player_controller"});f["default"]=a}),66);
__d("UFIStoryActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({CHANGE_ACCEPTED_ANSWER:"story_change_accepted_answer",COMMENTS_ARRIVED:"story_comments_arrived",PAGE_IN_COMMENTS:"story_page_in_comments",SHOW_REPLIES:"story_show_replies",SHOW_COMMENTS:"story_show_comments",SPAM_FETCHED:"story_spam_fetched",CHANGE_REACTION:"story_change_reaction",CHANGE_REACTION_FAILURE:"story_change_reaction_failure",CHANGE_REACTION_SUCCESS:"story_change_reaction_success",TOGGLE_REPLIES:"story_toggle_replies",FRIEND_TYPING:"story_friend_typing",SOMEONE_TYPING:"story_someone_typing",TYPING_STOPPED:"story_typing_stopped",LIVE_PIN_COMMENT:"story_live_pin_comment",LIVE_UNPIN_COMMENT:"story_live_unpin_comment",SHOW_FACECAST_REPLIES:"story_show_facecast_replies",HIDE_FACECAST_REPLIES:"story_hide_facecast_replies",ADD_FACECAST_REPLY:"story_add_facecast_reply",ADD_FACECAST_REPLIES:"story_add_facecast_replies",FACECAST_REPLIES_LOADED:"facecast_replies_loaded",SET_COMMENTS_SCROLL_DISTANCE:"set_comments_scroll_distance",HANDLE_NEW_COMMENTS:"handle_new_comments",HANDLE_NEW_FACECAST_REPLY:"handle_new_facecast_reply",SET_COMMENT_REACTIONS_MENU_SHOWN:"set_comment_reactions_menu_shown"});f["default"]=a}),66);
__d("UFIActionTypes",["UFIAddCommentActionType","UFICommentActionType","UFIInstanceActionType","UFIStoryActionType"],(function(a,b,c,d,e,f){"use strict";f.INSTANCE=b("UFIInstanceActionType"),f.STORY=b("UFIStoryActionType"),f.ADD_COMMENT=b("UFIAddCommentActionType"),f.COMMENT=b("UFICommentActionType")}),66);
__d("UFICommentVoteSyncStore",["FluxReduceStore","UFIActionTypes","UFIConstants","UFIDispatcherBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=c=a.call.apply(a,[this].concat(f))||this,c.reduce=function(a,b){var e;switch(b.type){case d("UFIActionTypes").INSTANCE.INIT:var f=b.payload,g=f.feedbacktarget?f.feedbacktarget:f.feedbacktargets&&f.feedbacktargets[0];if(!g)return a;g=f.comments.reduce(function(a,b){a[b.fbid]={voteCount:b.voteCount,voteState:b.voteState};return a},{});return babelHelpers["extends"]({},a,g);case d("UFIActionTypes").COMMENT.UPDATE_VOTE_COUNT_AND_STATE:return babelHelpers["extends"]({},a,(f={},f[b.fbid]={voteCount:b.voteCount?b.voteCount:0,voteState:b.voteState?b.voteState:d("UFIConstants").UFICommentVoteType.NONE},f));case d("UFIActionTypes").COMMENT.CHANGE_VOTE:g=c.getOptimisticVoteState(c.getVoteState(b.fbid),b.arrowType);f=c.getOptimisticVoteCount(b.fbid,g);return babelHelpers["extends"]({},a,(e={},e[b.fbid]={voteCount:f,voteState:g},e));case d("UFIActionTypes").COMMENT.CHANGE_VOTE_SUCCESS:case d("UFIActionTypes").COMMENT.CHANGE_VOTE_FAILURE:return babelHelpers["extends"]({},a,(f={},f[b.fbid]={voteCount:b.voteCount,voteState:b.voteState},f));default:return a}},b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.getInitialState=function(){return{}};c.getVoteCount=function(a){return!this.getState()[a]?0:this.getState()[a].voteCount};c.getVoteState=function(a){return!this.getState()[a]?d("UFIConstants").UFICommentVoteType.NONE:this.getState()[a].voteState};c.$UFICommentVoteSyncStore1=function(a){switch(a){case d("UFIConstants").UFICommentVoteType.UPVOTE:return 1;case d("UFIConstants").UFICommentVoteType.DOWNVOTE:return-1;case d("UFIConstants").UFICommentVoteType.NONE:default:return 0}};c.$UFICommentVoteSyncStore2=function(a,b){return this.$UFICommentVoteSyncStore1(b)-this.$UFICommentVoteSyncStore1(a)};c.getOptimisticVoteCount=function(a,b){var c=this.getVoteCount(a);a=this.$UFICommentVoteSyncStore2(this.getVoteState(a),b);return c+a};c.getOptimisticVoteState=function(a,b){return a===b?d("UFIConstants").UFICommentVoteType.NONE:b};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFIKeyValueStore",["FluxReduceStore","abstractMethod"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var d=b.prototype;d.getInitialState=function(){return{}};d.getValueFor=function(a){return this.getState()[a]||null};d.getStateKey=function(a){return a.instanceID};d.getStateValue=function(a){return c("abstractMethod")("UFIKeyValueStore","getStateValue")};d.reduce=function(a,b){var c=this.getStateKey(b);b=this.getStateValue(b);if(b!==null){var d;return babelHelpers["extends"]({},a,(d={},d[c]=b,d))}return a};return b}(c("FluxReduceStore"));a.__moduleID=f.id;g["default"]=a}),98);
__d("UFICommercialBreakStore",["UFIDispatcherBase","UFIKeyValueStore"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.getValueFor=function(b){return!!a.prototype.getValueFor.call(this,b)};c.getStateValue=function(a){switch(a.type){case"story_toggle_commercial_break":return a.inCommercial}return null};return b}(c("UFIKeyValueStore"));b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFIComposerIsTypingStore",["UFIDispatcherBase","UFIKeyValueStore"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.getStateKey=function(a){return a.ftentidentifier};c.getStateValue=function(a){switch(a.type){case"add_comment_submit_edit":return!1;case"add_comment_submit_new":return!1;case"add_comment_change_content":a=a.text.trim().length;return a>0}return null};return b}(c("UFIKeyValueStore"));b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFIFeedbackStore",["FluxReduceStore","UFIDispatcherBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.reduce=function(a,b){var c;switch(b.type){case"instance_init":var d=b.payload;d=d.feedbacktarget?d.feedbacktarget:d.feedbacktargets&&d.feedbacktargets[0];return!d?a:babelHelpers["extends"]({},a,(c={},c[b.ftentidentifier]=babelHelpers["extends"]({orderingmodes:[],defaultcommentorderingmode:""},d),c))}return a},b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.getInitialState=function(){return{}};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFIInteractionStore",["UFIDispatcherBase","UFIKeyValueStore"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.getValueFor=function(b){return!!a.prototype.getValueFor.call(this,b)};c.getStateValue=function(a){switch(a.type){case"add_comment_change_content":case"add_comment_submit_edit":case"add_comment_submit_new":case"comment_change_reaction":case"comment_edit":case"comment_remove":case"comment_toggle_like":case"comment_toggle_mark_as_spam":case"comment_translate":case"story_change_order_mode":case"story_toggle_comments":case"story_page_in_comments":case"story_show_replies":case"story_toggle_replies":return!0}return null};return b}(c("UFIKeyValueStore"));b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFILiveTypingStore",["FluxReduceStore","UFIDispatcherBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.reduce=function(a,c){var d=b.getNewFeedbackState(c.type);if(d!==null){var e;a=babelHelpers["extends"]({},a,(e={},e[c.ftentidentifier]=d,e))}return a},c)||babelHelpers.assertThisInitialized(d)}b.getNewFeedbackState=function(a){switch(a){case"story_friend_typing":case"story_someone_typing":return!0;case"story_typing_stopped":return!1;default:return null}};var c=b.prototype;c.getInitialState=function(){return{}};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFILiveVideoLoggingStore",["FluxReduceStore","LiveVideoViewerTypedLogger","UFIDispatcherBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=d=a.call.apply(a,[this].concat(f))||this,d.reduce=function(a,b){switch(b.type){case"story_show_facecast_replies":var d;new(c("LiveVideoViewerTypedLogger"))().setEvent("opened_reply_thread_from_comment").setCommentID(b.commentID).log();return babelHelpers["extends"]({},a,(d={},d[b.instanceID]={comment_id:b.commentID,time_opened_ms:Date.now()},d));case"story_hide_facecast_replies":if(!b.isExplicit)return a;d=a[b.instanceID];if(d==null)return a;new(c("LiveVideoViewerTypedLogger"))().setEvent("closed_reply_thread_explicitly").setCommentID(d.comment_id).setReplyThreadDurationMs(Date.now()-d.time_opened_ms).log();return babelHelpers["extends"]({},a,(b={},b[d.comment_id]=null,b));default:return a}},b)||babelHelpers.assertThisInitialized(d)}var d=b.prototype;d.getInitialState=function(){return{}};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFIOrderingModeStore",["invariant","FluxReduceStore","UFIDispatcherBase","UFIFeedbackStore"],(function(a,b,c,d,e,f,g,h){"use strict";function i(a,b){return a.filter(function(a){return a.selected}).map(function(a){return a.value}).pop()||b}a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=d=a.call.apply(a,[this].concat(f))||this,d.reduce=function(a,b){switch(b.type){case"instance_init":if(a.has(b.instanceID))return a;c("UFIDispatcherBase").waitFor([c("UFIFeedbackStore").getDispatchToken()]);var d=c("UFIFeedbackStore").getState()[b.ftentidentifier];a=new Map(a);return a.set(b.instanceID,i(d.orderingmodes,d.defaultcommentorderingmode));case"story_change_order_mode":(!a.has(b.instanceID)||a.get(b.instanceID)!==b.mode)&&(a=new Map(a),a.set(b.instanceID,b.mode));return a}return a},b)||babelHelpers.assertThisInitialized(d)}var d=b.prototype;d.getInitialState=function(){return new Map()};d.areEqual=function(a,b){return a===b};d.isLiveStreaming=function(a){return this.getState().get(a)=="live_streaming"};d.isInverted=function(a,b){var d=!1;b=c("UFIFeedbackStore").getState()[b];if(b){b=b.orderingmodes.filter(function(a){return a.selected}).pop();b&&(d=b.isBottomUpVideoCommentSreamingEnabled)}switch(a){case"recent_activity":case"ranked_threaded":case"ranked_unfiltered":case"live_streaming":return!d}return!1};d.getOrderingMode=function(a){a=this.getState().get(a);a!==void 0||h(0,2896);return a};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFIReactionPendingRequestsStore",["FluxReduceStore","UFIActionTypes","UFIDispatcherBase"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a+"-comment"}function i(a){return a+"-story"}function j(a,b){var c;return babelHelpers["extends"]({},a,(c={},c[b]=(a[b]||0)+1,c))}function k(a,b){var c;return babelHelpers["extends"]({},a,(c={},c[b]=(a[b]||0)-1,c))}a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=c=a.call.apply(a,[this].concat(f))||this,c.reduce=function(a,b){switch(b.type){case d("UFIActionTypes").STORY.CHANGE_REACTION:return j(a,i(b.ftentidentifier));case d("UFIActionTypes").COMMENT.CHANGE_REACTION:return j(a,h(b.fbid));case d("UFIActionTypes").STORY.CHANGE_REACTION_SUCCESS:case d("UFIActionTypes").STORY.CHANGE_REACTION_FAILURE:return k(a,i(b.ftentidentifier));case d("UFIActionTypes").COMMENT.CHANGE_REACTION_FAILURE:case d("UFIActionTypes").COMMENT.CHANGE_REACTION_SUCCESS:return k(a,h(b.fbid))}return a},b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.getInitialState=function(){return{}};c.getPendingRequestsForComment=function(a){return this.getState()[h(a)]||0};c.getPendingRequests=function(a){return this.getState()[i(a)]||0};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFIReactionSyncStore",["FluxReduceStore","UFIActionTypes","UFIDispatcherBase"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a+"-comment"}function i(a){return a+"-story"}a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=c=a.call.apply(a,[this].concat(f))||this,c.reduce=function(a,b){switch(b.type){case d("UFIActionTypes").INSTANCE.INIT:var c=b.payload;c=c.feedbacktarget?c.feedbacktarget:c.feedbacktargets&&c.feedbacktargets[0];if(!c)return a;var e=b.payload.comments.reduce(function(a,b){a[h(b.fbid)]=b.viewerreaction;return a},{});return babelHelpers["extends"]({},a,e,(e={},e[i(b.ftentidentifier)]=c.viewerreaction,e));case d("UFIActionTypes").STORY.CHANGE_REACTION_SUCCESS:return babelHelpers["extends"]({},a,(c={},c[i(b.ftentidentifier)]=b.reactionType,c));case d("UFIActionTypes").COMMENT.CHANGE_REACTION_SUCCESS:return babelHelpers["extends"]({},a,(e={},e[h(b.fbid)]=b.reactionType,e));default:return a}},b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.getInitialState=function(){return{}};c.getLastKnownCommentReaction=function(a){return this.getState()[h(a)]};c.getLastKnownReaction=function(a){return this.getState()[i(a)]};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFIVideoPlayerControllerStore",["FluxReduceStore","UFIDispatcherBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.reduce=function(a,b){switch(b.type){case"found_video_player_controller":var c;return babelHelpers["extends"]({},a,(c={},c[b.instanceID]={videoPlayerController:b.videoPlayerController},c));default:return a}},b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.getInitialState=function(){return{}};c.getVideoPlayerController=function(a){var b;return(b=this.getState())!=null?(b=b[a])!=null?b.videoPlayerController:b:b};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFISharedDispatcher",["UFICommentEditIDStore","UFICommentVisibilityStore","UFICommentVoteSyncStore","UFICommercialBreakStore","UFIComposerIsTypingStore","UFIDispatcherBase","UFIFeedbackStore","UFIInteractionStore","UFILivePinnedCommentStore","UFILiveTypingStore","UFILiveVideoLoggingStore","UFILocallyComposedCommentStore","UFIOrderingModeStore","UFIReactionPendingRequestsStore","UFIReactionSyncStore","UFISpamStore","UFIThreadedFacecastCommentsStore","UFIVideoPlayerControllerStore"],(function(a,b,c,d,e,f,g){"use strict";b("UFIFeedbackStore"),b("UFICommentEditIDStore"),b("UFICommentVisibilityStore"),b("UFICommentVoteSyncStore"),b("UFICommercialBreakStore"),b("UFIComposerIsTypingStore"),b("UFIFeedbackStore"),b("UFIInteractionStore"),b("UFILivePinnedCommentStore"),b("UFILiveTypingStore"),b("UFILocallyComposedCommentStore"),b("UFIOrderingModeStore"),b("UFIReactionPendingRequestsStore"),b("UFIReactionSyncStore"),b("UFISpamStore"),b("UFIThreadedFacecastCommentsStore"),b("UFILiveVideoLoggingStore"),b("UFIVideoPlayerControllerStore"),g["default"]=c("UFIDispatcherBase")}),98);
__d("UFICentralUpdatesLocalCommentAdapter",["ClientIDs","UFICentralUpdates","UFIDispatcherBase"],(function(a,b,c,d,e,f,g){"use strict";var h={},i=(f={},f[3]=a,f[12]=b,f);function j(){return c("UFICentralUpdates").subscribe("update-comments",function(a,b){if(b.comments){a=i[b.payloadsource];a&&b.comments.forEach(a)}})}function a(a){if(!d("ClientIDs").isExistingClientID(a.id))return;h[a.id]=a.ufiinstanceid;c("UFIDispatcherBase").dispatch({type:"CENTRALUPDATES_ADDED_COMMENT",instanceID:a.ufiinstanceid,ftentidentifier:a.ftentidentifier,clientID:a.id})}function b(a){if(!d("ClientIDs").isExistingClientID(a.clientid))return;var b=h[a.clientid];delete h[a.clientid];if(!b)return;c("UFIDispatcherBase").dispatch({type:"CENTRALUPDATES_SAVED_COMMENT",instanceID:b,ftentidentifier:a.ftentidentifier,clientID:a.clientid,commentID:a.id})}var k;function e(){if(!k){k=j();return k}return null}g.subscribeOnce=e}),98);
__d("UFIPagedCommentListImpl",["ClientIDs","KeyedCallbackManager","UFICentralUpdates","UFICommentLogger","UFIConfig","UFIConstants","UFIFeedbackTargets"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=this;this.actorID=null;this.basePermalink=null;this.commentPermalinks=Object.create(null);this.count=0;this.dataSource=new(c("KeyedCallbackManager"))();this.deletedComments=Object.create(null);this.deletedCount=0;this.lastRequestedLength=0;this.lastRequestedOffset=0;this.feedbackTargetID=a;d("UFIFeedbackTargets").getFeedbackTarget(this.feedbackTargetID,function(a){b.actorID=a.actorforpost,b.basePermalink=a.permalink})}var b=a.prototype;b.setClientHasAll=function(a){};b.addOrUpdateComment=function(a){if(!a)return;a.__typename==="local"?this.$1(a.id):this.$2(a.id,a.clientid,a.legacyid);c("UFICentralUpdates").didUpdateFeedback(this.feedbackTargetID)};b.$1=function(a){this.dataSource.setResource(this.count,a),this.count++};b.$2=function(a,b,e){var f=b&&d("ClientIDs").isExistingClientID(b),g=this.dataSource.getAllResources(),h={};for(var i in g){var j=g[Number(i)];h[j]=i}if(f&&b&&b in h){h[a]=h[b];j=h[b];this.dataSource.setResource(j,a);d("UFIConfig").logCommentPost&&c("UFICommentLogger").logNewCommentReceived(b,Date.now())}else!h[a]&&b&&this.$1(a);e&&a in h&&(this.commentPermalinks[a]=this.buildCommentPermalink(a,e,h[a]))};b.addCommentIDs=function(a,b,e){var f={};for(var g=0;g<b;g++)f[a+g]=e[g]||d("UFIConstants").unavailableCommentKey;this.dataSource.addResourcesAndExecute(f);c("UFICentralUpdates").didUpdateFeedback(this.feedbackTargetID)};b.getComments=function(a,b,c,d){var e=this,f=new Array(b).fill().map(function(b,c){return c+a}),g=this.dataSource.getUnavailableResourcesFromRequest(f);if(g.length){var h=Math.min.apply(Math,g);g=Math.max.apply(Math,g);var i=h;g=g-h+1;(i<this.lastRequestedOffset||i+g>this.lastRequestedOffset+this.lastRequestedLength)&&(this.lastRequestedOffset=i,this.lastRequestedLength=g,this.fetchComments(i,g,c))}else this.dataSource.executeOrEnqueue(f,function(c){return d(e.commentsFromCommentIDs(c,a,b))})};b.getCommentsOrThrow=function(a){var b=this;a=[a.getLength(),a.getOffset()];var c=a[0],d=a[1],e={};new Array(c).fill().forEach(function(a,c){a=c+d;c=b.dataSource.getResource(a);if(!c)throw new Error("Tried to get nonexistent comment");e[a]=c});return this.commentsFromCommentIDs(e,d,c)};b.fetchComments=function(a,b,c){};b.commentsFromCommentIDs=function(a,b,c){return{}};b.reset=function(){var a=this.dataSource.getAllResources();this.dataSource.reset();this.count=0;this.deletedCount=0;this.deletedComments={};this.lastRequestedOffset=0;this.lastRequestedLength=0;return a};b.deleteComment=function(a){a in this.deletedComments||(this.deletedComments[a]=!0,this.deletedCount++)};b.updateCommentCount=function(a){this.count=a,this.deletedCount=0};b.getFeedbackTargetID=function(){return this.feedbackTargetID};b.getCommentCount=function(){return this.count};b.getDeletedCount=function(){return this.deletedCount};b.getDisplayedCommentCount=function(){return this.count-this.deletedCount};b.getBasePermalink=function(){return this.basePermalink};b.buildCommentPermalink=function(a,b,c){return null};b.getPermalinkForComment=function(a){return this.commentPermalinks[a]};return a}();g["default"]=a}),98);
__d("UFIReplyCommentListImpl",["ActorURI","MercuryServerDispatcher","UFICommentLogger","UFIComments","UFIConfig","UFIPagedCommentListImpl","URI"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d){b=a.call(this,b)||this;b.parentCommentID=c;b.containerOrderingMode=d;return b}var e=b.prototype;e.fetchComments=function(a,b,e){d("UFIConfig").logCommentLoad&&c("UFICommentLogger").logCommentFetch(this.feedbackTargetID,Date.now(),{request_length:b,is_reply:!0});a={ft_ent_identifier:this.feedbackTargetID,parent_comment_ids:[this.parentCommentID],source:null,offsets:[a],lengths:[b],feed_context:e?e.feedContext:null,numpagerclicks:e?e.numPagerClicks:null,containerorderingmode:this.containerOrderingMode,translate_all:e?e.translateAll:null};(!e||!e.viewAs)&&(a[d("ActorURI").PARAMETER_ACTOR]=this.actorID);d("MercuryServerDispatcher").trySend("/ajax/ufi/reply_fetch.php",a)};e.commentsFromCommentIDs=function(a,b,c){var e={};for(var f=0;f<c;f++){var g=d("UFIComments").getComment(a[b+f]);g&&(e[b+f]=g)}return e};e.reset=function(){var b=a.prototype.reset.call(this),c={};for(var e in b){var f=b[e];c[f]=!0}d("UFIComments").resetComments(c);return b};e.getParentCommentID=function(){return this.parentCommentID};e.buildCommentPermalink=function(a,b,d){if(!this.basePermalink)return null;a=this.getParentCommentID().split("_");d=b;a.length===2&&(d=a[1]);return new(c("URI"))(this.basePermalink).addQueryData({comment_id:d,reply_comment_id:b}).toString()};return b}(c("UFIPagedCommentListImpl"));d("MercuryServerDispatcher").registerEndpoints({"/ajax/ufi/reply_fetch.php":{mode:d("MercuryServerDispatcher").IMMEDIATE}});g["default"]=a}),98);
__d("UFIToplevelPagedCommentListImpl",["ActorURI","MercuryServerDispatcher","UFICommentLogger","UFIComments","UFIConfig","UFIOrderingModeStore","UFIPagedCommentListImpl","URI"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d){b=a.call(this,b)||this;b.clientHasAll=!1;b.orderingMode=c;b.section=d||"default";b.clientHasAll=!1;return b}var e=b.prototype;e.fetchComments=function(a,b,e){d("UFIConfig").logCommentLoad&&c("UFICommentLogger").logCommentFetch(this.feedbackTargetID,Date.now(),{request_length:b,is_reply:!1});a={ft_ent_identifier:this.feedbackTargetID,viewas:e&&e.viewAs?e.viewAs+"":null,source:e&&e.feedbackSource,offset:a,length:b,orderingmode:this.orderingMode,section:this.section,direction:e&&e.direction,feed_context:e?e.feedContext:null,numpagerclicks:e?e.numPagerClicks:null,translate_all:e?e.translateAll:null,clientcommentcount:this.count};(this.orderingMode!=="ranked_threaded"||this.orderingMode!=="ranked_unfiltered"||this.orderingMode!=="recent_activity")&&delete a.clientcommentcount;(!e||!e.viewAs)&&(a[d("ActorURI").PARAMETER_ACTOR]=this.actorID);e&&e.interactionRequestCorrelationID&&(a.ircid=e.interactionRequestCorrelationID);d("MercuryServerDispatcher").trySend("/ajax/ufi/comment_fetch.php",a)};e.commentsFromCommentIDs=function(a,b,e){var f={},g=b,h=b+e-1,i=c("UFIOrderingModeStore").isInverted(this.orderingMode,this.feedbackTargetID);for(var j=0;j<e;j++){var k=i?h-j:g+j;k=d("UFIComments").getComment(a[k]);k&&(f[b+j]=k)}return f};e.getOrderingMode=function(){return this.orderingMode};e.getCommentSection=function(){return this.section};e.setClientHasAll=function(a){this.clientHasAll=a};e.getClientHasAll=function(){return this.clientHasAll};e.buildCommentPermalink=function(a,b,d){return!this.basePermalink?null:new(c("URI"))(this.basePermalink).addQueryData({comment_id:b}).toString()};return b}(c("UFIPagedCommentListImpl"));d("MercuryServerDispatcher").registerEndpoints({"/ajax/ufi/comment_fetch.php":{mode:d("MercuryServerDispatcher").IMMEDIATE}});g["default"]=a}),98);
__d("UFICentralUpdates",["Arbiter","ArbiterMixin","LiveTimer","ODS","ShortProfiles","UFIConstants","UFIUserActions"],(function(a,b,c,d,e,f,g){"use strict";d("ODS").setEntitySample("feedback",1e-4);var h=0,i={},j={},k=[];function l(){if(!h){var a=i,b=j;i={};j={};Object.keys(a).length&&n("feedback-updated",a);Object.keys(b).length&&n("comments-updated",b);k.pop()}}function m(){if(k.length)return k[k.length-1];else return d("UFIConstants").UFIPayloadSourceType.UNKNOWN}function n(a,b){o.inform(a,{updates:b,payloadSource:m()})}var o=babelHelpers["extends"]({},c("ArbiterMixin"),{handleUpdateWithUserAction:function(a,b){b.actions.forEach(function(e){a==d("UFIConstants").UFIPayloadSourceType.ENDPOINT_HIDE_COMMENT?Object.prototype.hasOwnProperty.call(e,"commentid")&&(c("UFIUserActions").setHideAsSpam(e.commentid,!0,{source:13}),c("Arbiter").inform("bulk_actions_hidden",{})):o.handleUpdate(a,b)})},handleUpdate:function(a,b){Object.keys(b).length&&o.synchronizeInforms(function(){k.push(a);var c=babelHelpers["extends"]({payloadsource:m()},b);c.adjustedRanges&&o.inform("update-ranges",c);o.inform("update-feedback",c);o.inform("update-comment-lists",c);o.inform("update-comments",c);o.inform("update-actions",c);d("ShortProfiles").setMulti(b.profiles||{});b.servertime&&d("LiveTimer").restart(b.servertime)})},didUpdateFeedback:function(a){i[a]=!0,l()},didUpdateComment:function(a){j[a]=!0,l()},synchronizeInforms:function(a){h++;try{a()}catch(a){throw a}finally{h--,l()}}});a=o;g["default"]=a}),98);
__d("UFICommentAction",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return{type:"bulk_review",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b}}function b(a,b,c,d){return{type:"comment_change_reaction",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,reactionType:c,target:d}}function c(a,b,c){return{type:"comment_change_reaction_success",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,reactionType:c}}function d(a,b,c){return{type:"comment_change_reaction_failure",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,reactionType:c}}function e(a,b,c,d,e){return{arrowType:e,comment:b,currentVoteState:d,fbid:b.fbid,ftentidentifier:a.ftentidentifier,instanceID:a.instanceid,target:c,type:"comment_change_vote"}}function g(a,b,c,d){return{comment:b,fbid:b.fbid,ftentidentifier:a.ftentidentifier,instanceID:a.instanceid,type:"comment_change_vote_failure",voteCount:c,voteState:d}}function h(a,b,c,d){return{comment:b,fbid:b.fbid,ftentidentifier:a.ftentidentifier,instanceID:a.instanceid,type:"comment_change_vote_success",voteCount:c,voteState:d}}function i(a,b,c,d){return{fbid:b,ftentidentifier:a.ftentidentifier,instanceID:a.instanceid,type:"comment_update_vote_count_and_state",voteCount:c,voteState:d}}function j(a,b){return{type:"comment_mounted",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.comment.fbid,renderedComment:b,contextArgs:a}}function k(a,b){return{type:"comment_unmounted",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.comment.fbid,renderedComment:b,contextArgs:a}}function l(a,b,c){return{type:"comment_change_visibility",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.comment.fbid,renderedComment:b,contextArgs:a,visibility:c}}function m(a,b){return{type:"comment_edit",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b}}function n(a,b,c,d,e){e===void 0&&(e=!1);return{type:"comment_remove",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,target:c,onConfirm:d,skipConfirmation:e}}function o(a,b,c,d){return{type:"comment_remove_and_block",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,target:c,onConfirm:d}}function p(a,b,c,d){return{type:"comment_delete_and_commenter_remove",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,target:c,onConfirm:d}}function q(a,b,c,d){return{type:"commenter_muted",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,target:c,onConfirm:d}}function r(a,b,c){return{type:"comment_toggle_text_delights",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,target:c}}function s(a,b,c){return{type:"comment_remove_preview",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,target:c}}function t(a,b,c){return{type:"comment_toggle_like",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,like:!b.hasviewerliked,target:c}}function u(a,b,c){return{type:"comment_translate",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,trigger:c}}function v(a,b,c){return{type:"comment_toggle_mark_as_spam",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,is_spam:!0,target:c}}function w(a,b,c){return{type:"comment_toggle_mark_as_spam",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,is_spam:!1,target:c}}function x(a,b,c,d){return{type:"comment_toggle_inline_ban",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,is_banned:!0,ownerid:d,target:c}}function y(a,b,c,d){return{type:"comment_toggle_inline_ban",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,is_banned:!1,ownerid:d,target:c}}function z(a,b,c,d){return{type:"comment_toggle_inline_stream_ban",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,is_banned:!0,ownerid:d,target:c}}function A(a,b,c,d){return{type:"comment_toggle_inline_stream_ban",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,is_banned:!1,ownerid:d,target:c}}function B(a,b,c,d,e){return{type:"comment_toggle_inline_suspension",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,is_suspended:!0,suspension_duration_seconds:e,ownerid:d,target:c}}function C(a,b,c,d){return{type:"comment_toggle_inline_suspension",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,is_suspended:!1,suspension_duration_seconds:0,ownerid:d,target:c}}function D(a,b){return{type:"embed",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b}}function E(a,b,c){return{type:"comment_delete_with_feedback",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,target:c}}function F(a,b,c){return{comment:b,type:"comment_change_author_pin",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,pinnedByAuthor:c}}function G(a,b){return{type:"comment_manage_constituent_badge",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b}}function H(a,b,c){return{type:"comment_toggle_keep_spam",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b,target:c}}function I(a,b,c,d){return{type:"comment_toggle_appeal_spam",instanceID:a.instanceid,ftentidentifier:b.fbid,fbid:b.fbid,comment:b,target:c,feedback:d}}function J(a,b,c,d){return{type:"comment_toggle_secure_account",instanceID:a.instanceid,ftentidentifier:b.fbid,fbid:b.fbid,comment:b,target:c,feedback:d}}f.bulkReview=a;f.changeReaction=b;f.changeReactionSuccess=c;f.changeReactionFailure=d;f.changeVote=e;f.changeVoteFailure=g;f.changeVoteSuccess=h;f.updateVoteCountAndState=i;f.mounted=j;f.unmounted=k;f.changeVisibility=l;f.edit=m;f.remove=n;f.removeAndBlock=o;f.delete_comment_and_remove_commenter=p;f.mute_member=q;f.toggle_text_delights=r;f.removePreview=s;f.toggleLike=t;f.translate=u;f.markAsSpam=v;f.markAsNotSpam=w;f.inlineBan=x;f.undoInlineBan=y;f.inlineStreamBan=z;f.undoInlineStreamBan=A;f.inlineSuspension=B;f.undoInlineSuspension=C;f.embed=D;f.deleteCommentWithFeedback=E;f.pinByAuthor=F;f.manageConstituentBadge=G;f.keepSpam=H;f.appealSpam=I;f.secureAccount=J}),66);
__d("UFICommentVoteUserActions",["AsyncRequest","AsyncResponse","ChannelClientID","ClientIDs","ThisControllerNoLongerExists","UFICentralUpdates","UFICommentAction","UFICommentVoteSyncStore","UFIComments","UFIConstants","UFIFeedbackTargets","UFISharedDispatcher"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function a(a,b,e,f,g,l){var m=d("UFIComments").getComment(a),n=c("UFICommentVoteSyncStore").getVoteCount(b),o=c("UFICommentVoteSyncStore").getOptimisticVoteState(f,e),p=c("UFICommentVoteSyncStore").getOptimisticVoteCount(b,o);if(!m||m.__typename!=="saved"||f===o)return;d("UFIFeedbackTargets").getFeedbackTarget(m.ftentidentifier,function(b){b=k(m,b,p,o);c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:b});h&&h.abort();b=d("ThisControllerNoLongerExists").__DEADURI__("k0233k87l");h=new(c("AsyncRequest"))().setURI(b).setMethod("POST").setData({client_id:d("ClientIDs").getNewClientID(),comment_id:a,ft_ent_identifier:m.ftentidentifier,instance_id:g.instanceid,legacy_id:m.legacyid,new_vote_count:p,new_vote_state:o,old_vote_count:n,old_vote_state:f,session_id:d("ChannelClientID").getID(),source:g.source}).setErrorHandler(function(a){i(a)}).setHandler(function(a){j(a)})});h&&h.send()}function i(b){var a=b.request;if(!a||!a.data)return;a=a.data;var e=d("UFIComments").getComment(a.comment_id);if(!e||e.__typename!=="saved")return;var f=a.ft_ent_identifier,g=a.instance_id,i=a.old_vote_count;a=a.old_vote_state;if(!f||!g)return;c("UFISharedDispatcher").dispatch(d("UFICommentAction").changeVoteFailure({instanceid:g,ftentidentifier:f},e,i,a));c("AsyncResponse").defaultErrorHandler(b)}function j(a){a=a.request;if(!a||!a.data)return;a=a.data;var b=d("UFIComments").getComment(a.comment_id);if(!b||b.__typename!=="saved")return;var e=a.ft_ent_identifier,f=a.instance_id,g=a.new_vote_count;a=a.new_vote_state;if(!e||!f)return;c("UFISharedDispatcher").dispatch(d("UFICommentAction").changeVoteSuccess({instanceid:f,ftentidentifier:e},b,g,a))}function k(a,b,c,e){var f=a.id;b=[l(a,c,e,f,b.actorforpost)];a.voteState!==e&&b.push({commentID:f,actionType:d("UFIConstants").UFIActionType.COMMENT_VOTE,voteCount:c,voteEnabled:!0,voteState:e});return b}function l(a,b,c,e,f){return{actionType:d("UFIConstants").UFIActionType.COMMENT_VOTE,commentID:e,voteCount:b,voteEnabled:a.voteEnabled,voteState:c}}g.changeCommentVote=a}),98);
__d("UFIComments",["invariant","ClientIDs","ImmutableObject","UFICentralUpdates","UFIConstants","randomInt"],(function(a,b,c,d,e,f,g,h){"use strict";var i=5,j={},k={},l={},m={},n={};m.shareOnComment=n;var o="DONT_SHOW_SHARE_OPTION";function p(a){return a in k?k[a]:a}function q(a,b){a.forEach(function(a){var e=a.ftentidentifier,f=d("UFIConstants").UFIPayloadSourceType,g=a.clientid,h=!1,m=babelHelpers["extends"]({},a);if(g){delete m.clientid;h=d("ClientIDs").isExistingClientID(g);if(h&&k[g])return}(b===d("UFIConstants").UFIPayloadSourceType.LIVE_SEND||b===d("UFIConstants").UFIPayloadSourceType.STREAMING)&&(m.islive=!0);(b===f.ENDPOINT_COMMENT_FETCH||b===f.ENDPOINT_ID_COMMENT_FETCH)&&(m.fromfetch=!0);h&&j[g]&&(m.ufiinstanceid=j[g].ufiinstanceid,m.trackingID=j[g].trackingID,k[g]=a.id,l[a.id]=g,j[a.id]=j[g],delete j[g],c("UFICentralUpdates").didUpdateComment(g));if(b===f.LIVE_SEND||b===d("UFIConstants").UFIPayloadSourceType.STREAMING||b===f.USER_ACTION||b===f.ENDPOINT_ADD_COMMENT||b===f.ENDPOINT_EDIT_COMMENT){m.isunseen=!0;if(a.body&&a.body.text&&a.body.text.trim().split(/\s+/).length>=i&&(b===f.USER_ACTION||b===f.ENDPOINT_ADD_COMMENT)){h=n[e];h!==o&&(n[e]=!h||a.id===h||K(a.id)===h?a.id:o)}}M(a.id,new(c("ImmutableObject"))(m));c("UFICentralUpdates").didUpdateComment(a.id);c("UFICentralUpdates").didUpdateFeedback(e)})}function r(a,b){for(var c=0;c<a.length;c++){var e=a[c];switch(e.actiontype){case d("UFIConstants").UFIActionType.LIKE_ACTION:L(e.entidentifier)&&u(e.clientid,e.entidentifier,e.hasviewerliked,e.likecount,e.reactiondata,b);break;case d("UFIConstants").UFIActionType.COMMENT_LIKE:u(e.clientid,e.commentid,e.viewerliked,e.likecount,e.reactiondata,b);break;case d("UFIConstants").UFIActionType.MUTE_MEMBER:v(e);break;case d("UFIConstants").UFIActionType.REACTION:L(e.entidentifier)&&w(e.entidentifier,e);break;case d("UFIConstants").UFIActionType.COMMENT_REACTION:w(e.commentid,e);break;case d("UFIConstants").UFIActionType.DELETE_COMMENT:A(e);break;case d("UFIConstants").UFIActionType.LIVE_DELETE_COMMENT:B(e);break;case d("UFIConstants").UFIActionType.CHANGE_ACCEPTED_ANSWER:C(e);break;case d("UFIConstants").UFIActionType.REMOVE_PREVIEW:D(e);break;case d("UFIConstants").UFIActionType.COMMENT_SET_SPAM:E(e);break;case d("UFIConstants").UFIActionType.COMMENT_KEEP_SPAM:F(e);break;case d("UFIConstants").UFIActionType.CONFIRM_COMMENT_REMOVAL:G(e);break;case d("UFIConstants").UFIActionType.TRANSLATE_COMMENT:y(e);break;case d("UFIConstants").UFIActionType.COMMENT_LIKECOUNT_UPDATE:x(e);break;case d("UFIConstants").UFIActionType.UPDATE_CONSTITUENT_BADGE:I(e);break;case d("UFIConstants").UFIActionType.COMMENT_VOTE:t(e);break;case d("UFIConstants").UFIActionType.COMMENT_AUTHOR_PIN_CHANGE:s(e)}}}function s(a){var b=L(a.commentid);b&&J(b.id,{ispinnedbyauthor:a.ispinnedbyauthor})}function t(a){var b=L(a.commentID);b&&J(b.id,{voteCount:a.voteCount,voteEnabled:a.voteEnabled,voteState:a.voteState})}function u(a,b,e,f,g,h){h=L(b);if(h){h={};a=a&&d("ClientIDs").isExistingClientID(a);a||(h.hasviewerliked=e,h.likecount=f,g&&(h.reactioncount=g.reactioncount,h.reactioncountmap=g.reactioncountmap,h.reactioncountreduced=g.reactioncountreduced,h.viewerreaction=g.viewerreaction));h.likeconfirmhash=c("randomInt")(0,1024);J(b,h)}}function v(a){for(var b in j){var c=j[b];if(c.author===a.authorid){c={ismuted:a.shouldmute};J(b,c)}}}function w(a,b){var c=L(a);if(c){var e={};if(b.clientid&&d("ClientIDs").isExistingClientID(b.clientid)&&b.viewerreaction!==c.viewerreaction)return;e.hasviewerliked=b.hasviewerliked;e.likecount=b.likecount;e.reactioncount=b.reactioncount;e.reactioncountmap=b.reactioncountmap;e.reactioncountreduced=b.reactioncountreduced;e.viewerreaction=b.viewerreaction;J(a,e)}}function x(a){var b=L(a.commentid);if(b&&a.hasviewerliked===b.hasviewerliked){b={likecount:a.likecount,likeconfirmhash:c("randomInt")(0,1024)};J(a.commentid,b)}}function y(a){var b=a.commentid,c=L(b);if(c){c={translationdata:a.translationdata};J(b,c)}}function z(a){a={reportLink:a.reportLink,commenterIsFOF:a.commenterIsFOF,userIsMinor:a.userIsMinor,giveFeedbackLink:a.giveFeedbackLink,reportOptionsLink:a.reportOptionsLink,isBroadcast:a.isBroadcast,showStreamBanControls:a.showStreamBanControls};return a}function A(a){a=L(a.commentid);a&&H(a,d("UFIConstants").UFIStatus.DELETED)}function B(a){a=L(a.commentid);a&&a.status!==d("UFIConstants").UFIStatus.DELETED&&H(a,d("UFIConstants").UFIStatus.LIVE_DELETED)}function C(a){J(a.commentid,{postacceptedanswer:a.isaccepted?a.commentid:null})}function D(a){J(a.commentid,{attachment:null})}function E(a){var b=L(a.commentid);a=a.shouldHideAsSpam?d("UFIConstants").UFIStatus.SPAM_DISPLAY:null;b&&H(b,a)}function F(a){a=L(a.commentid);a&&J(a.id,{needsApproval:!1,isApproved:!0})}function G(a){J(a.commentid,z(a))}function H(a,b){J(a.id,{priorstatus:a.status,status:b})}function I(a){var b=L(a.commentid);if(b){b={constituentTitle:a.constituentTitle,hasConstituentBadge:a.hasConstituentBadge};J(a.commentid,b)}}function J(a,b){var d=L(a)||new(c("ImmutableObject"))({});M(a,c("ImmutableObject").set(d,b));c("UFICentralUpdates").didUpdateComment(d.id);c("UFICentralUpdates").didUpdateFeedback(d.ftentidentifier)}function a(a){return"comment"+(a in l?l[a]:a)}function K(a){return a in l?l[a]:a}function L(a){return a===d("UFIConstants").unavailableCommentKey?null:j[p(a)]}function M(a,b){b instanceof c("ImmutableObject")||h(0,11854),j[p(a)]=b}function b(a,b){a.length!==0||h(0,4389),m[a]=b}function e(a){return m[a]}function f(a){for(var a in a)delete j[p(a)]}function N(a){var b=[];for(var c in j){var d=j[c];d.author==a&&b.push(d)}return b}function O(a){var b=[];for(var c in j){var d=j[c];d.ftentidentifier==a&&b.push(d)}return b}c("UFICentralUpdates").subscribe("update-comments",function(a,b){b.comments&&b.comments.length&&q(b.comments,b.payloadsource),b.privatecomments&&b.privatecomments.length&&q(b.privatecomments,b.payloadsource),b.pinnedcomments&&b.pinnedcomments.length&&q(b.pinnedcomments,b.payloadsource),b.livethreadedcomments&&b.livethreadedcomments.length&&q(b.livethreadedcomments,b.payloadsource),b.authorpinnedcomments&&b.authorpinnedcomments.length&&q(b.authorpinnedcomments,b.payloadsource)});c("UFICentralUpdates").subscribe("update-actions",function(a,b){b.actions&&b.actions.length&&r(b.actions,b.payloadsource)});g.getRenderKey=a;g.getLocalID=K;g.getComment=L;g.setComment=M;g.setCacheVariable=b;g.getCacheVariable=e;g.resetComments=f;g.getCommentsForAuthor=N;g.getCommentsForFTEntIdentifier=O}),102);
__d("UFIFeedbackTargets",["Bootloader","KeyedCallbackManager","UFICentralUpdates"],(function(a,b,c,d,e,f,g){"use strict";var h=new(c("KeyedCallbackManager"))();function i(a){var b;if(!a)return;var d=babelHelpers["extends"]({},a);delete d.commentlist;delete d.commentcount;c("UFICentralUpdates").didUpdateFeedback(a.entidentifier);h.addResourcesAndExecute((b={},b[a.entidentifier]=d,b))}function j(a,b){c("Bootloader").loadModules(["UFIFeedbackMutator"],function(c){for(var d=0;d<a.length;d++){var e=a[d];e.arecommentsdisabled=!!e.arecommentsdisabled;e.cancomment=!!e.cancomment;e.hasviewerliked=!!e.hasviewerliked;e.hasviewersubscribed=!!e.hasviewersubscribed;e.likecount=e.likecount||0;var f=h.getResource(e.entidentifier);if(!f)break;var g=c.getHandlerForAction(e);i(g(f,e,b))}},"UFIFeedbackTargets")}function a(a,b){a=h.executeOrEnqueue(a,b);return a}function b(a){return h.getResource(a)||null}function d(a){h.unsubscribe(a)}c("UFICentralUpdates").subscribe("update-feedback",function(a,b){a=b.feedbacktarget?b.feedbacktarget:b.feedbacktargets&&b.feedbacktargets[0];a&&i(a)});c("UFICentralUpdates").subscribe("update-actions",function(a,b){b.actions&&b.actions.length&&j(b.actions,b.payloadsource)});g.getFeedbackTarget=a;g.getFeedbackTargetIfExists=b;g.unsubscribe=d}),102);
__d("UFIReactionsUtils",[],(function(a,b,c,d,e,f){function a(a,b,c,d,e){e===void 0&&(e=null);b=parseInt(b,10);var f=!!b,g=a.reactorids?a.reactorids.slice(0):[],h=g.indexOf(c),i=0;f?h<0&&(c&&g.unshift(c),i=1):h>-1&&(g.splice(h,1),i=-1);h=Math.max(a.reactioncount+i,0);i=a.reactioncountreduced;i&&!isNaN(i)&&(d?i=d(h):i=h.toString());d=a.reactioncountmap||{};var j=a.reactioncountmapbyid||{},k,l=a.viewerreaction,m=a.viewerreactionid;l&&d[l]&&(d[l]["default"]=Math.max((d[l]["default"]||0)-1,0),k=d[l].reduced,k&&!isNaN(k)&&(d[l].reduced=d[l]["default"].toString()));m&&j[m]&&(j[m]["default"]=Math.max((j[m]["default"]||0)-1,0),k=j[m].reduced,k&&!isNaN(k)&&(j[m].reduced=j[m]["default"].toString()));f&&d[b]&&(d[b]["default"]=(d[b]["default"]||0)+1,k=d[b].reduced,k&&!isNaN(k)&&(d[b].reduced=d[b]["default"].toString()));f&&e!==null&&(j[e]||(j[e]={}),j[e]["default"]=(j[e]["default"]||0)+1,k=j[e].reduced,k&&!isNaN(k)&&(j[e].reduced=j[e]["default"].toString()));m=a.userreactions;(!m||Array.isArray(m))&&(m={});c&&(f?m[c]=b:delete m[c]);k=null;if(a.reactionsentences){f=!(l&&b);k={current:a.reactionsentences[f?"alternate":"current"],alternate:a.reactionsentences[f?"current":"alternate"]}}return{reactioncount:h,reactioncountmap:d,reactioncountmapbyid:j,reactioncountreduced:i,reactionsentences:k,reactorids:g,userreactions:m,viewerreaction:b,viewerreactionid:e}}function b(a){var b={};if(!a)return b;for(var c=0;c<a.length;c++){var d=a[c],e=d.feedback_reaction.key;b[e]={"default":d.reactors&&d.reactors.count,reduced:d.reactors&&d.reactors.display_count}}return b}f.getReactionData=a;f.getReactionCountMapFromSummary=b}),66);
__d("UFIStoryAction",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){return{type:"story_change_accepted_answer",instanceID:a.instanceid,ftentidentifier:b.ftentidentifier,comment:b,doAccept:c}}function b(a,b,c,d,e,f,g){return{type:"story_comments_arrived",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,section:e,newOffset:b,newLength:c,source:d,interactionRequestCorrelationID:f,liveVideoCommentPermalinkID:g}}function c(a,b,c,d,e){return{type:"story_page_in_comments",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,interactionRequestCorrelationID:a.interactionRequestCorrelationID,commentID:b,direction:c,nextRange:d,section:e}}function d(a){return{type:"story_show_comments",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}}function e(a,b,c){return{type:"story_show_replies",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentID:b,initiatorComment:c}}function g(a,b,c,d){return{type:"story_spam_fetched",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,viewas:b,commentIDs:c,parentCommentID:d}}function h(a,b,c,d,e){d===void 0&&(d=null);e===void 0&&(e=null);return{type:"story_change_reaction",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,contextArgs:a,reactionType:b,target:c,sphericalYaw:d,sphericalPitch:e}}function i(a,b){return{type:"story_change_reaction_success",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,reactionType:b}}function j(a,b){return{type:"story_change_reaction_failure",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,reactionType:b}}function k(a,b){return{type:"story_toggle_replies",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentID:b}}function l(a){return{type:"story_someone_typing",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}}function m(a){return{type:"story_typing_stopped",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}}function n(a,b,c){c===void 0&&(c=null);return{type:"story_live_pin_comment",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentID:b,pinEventID:c}}function o(a,b){b===void 0&&(b=null);return{type:"story_live_unpin_comment",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentID:null,pinEventID:b}}function p(a,b){return{type:"story_show_facecast_replies",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentID:b}}function q(a,b){return{type:"story_hide_facecast_replies",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,isExplicit:b}}function r(a,b){return{type:"story_add_facecast_reply",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,replyCommentID:b}}function s(a,b){return{type:"story_add_facecast_replies",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,replyCommentIDs:b}}function t(a,b){return{type:"facecast_replies_loaded",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentID:b}}function u(a,b){return{type:"set_comments_scroll_distance",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,scrollDist:b}}function v(a,b){return{type:"handle_new_comments",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,numComments:b}}function w(a,b){return{type:"handle_new_facecast_reply",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,replyCommentID:b}}function x(a,b){return{type:"set_comment_reactions_menu_shown",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentReactionsMenuShown:b}}f.changeAcceptedAnswer=a;f.commentsArrived=b;f.pageInComments=c;f.showComments=d;f.showReplies=e;f.spamFetched=g;f.changeReaction=h;f.changeReactionSuccess=i;f.changeReactionFailure=j;f.toggleReplies=k;f.someoneTyping=l;f.typingStopped=m;f.pinComment=n;f.unpinComment=o;f.showFacecastReplies=p;f.hideFacecastReplies=q;f.addFacecastReply=r;f.addFacecastReplies=s;f.facecastRepliesLoaded=t;f.setCommentsScrollDistance=u;f.handleNewComments=v;f.handleNewFacecastReply=w;f.setCommentReactionsMenuShown=x}),66);
__d("Nectar",["Env","getContextualParent"],(function(a,b,c,d,e,f){var g;function h(a){a.nctr||(a.nctr={})}function i(a){if((g||(g=b("Env"))).module||!a)return(g||(g=b("Env"))).module;var c={fbpage_fan_confirm:!0,photos_snowlift:!0},d;while(a&&a.getAttribute){var e=a.getAttribute("id");if(e!=null&&e.startsWith("pagelet_"))return e;!d&&c[e]&&(d=e);a=b("getContextualParent")(a)}return d}a={addModuleData:function(a,b){b=i(b);b&&(h(a),a.nctr._mod=b)}};e.exports=a}),null);
__d("UFIUserActionUtils",["Nectar","TrackingNodes","collectDataAttributes"],(function(a,b,c,d,e,f,g){function a(a){if(!a)return{ft:{}};var b={ft:c("collectDataAttributes")(a,["ft"]).ft};if(h(b.ft.tn))return{};d("Nectar").addModuleData(b,a);return b}function h(a){if(a){a=c("TrackingNodes").parseTrackingNodeString(a);for(var b=0;b<a.length;b++){var d=a[b][0];switch(d){case c("TrackingNodes").types.COMMENT:return!0}}}return!1}g.trackingData=a}),98);
__d("XUFICommentReactionController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/comment/reaction/",{reaction_type:{type:"Enum",enumType:0}})}),null);
__d("XUFIReactionController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/reaction/",{client_id:{type:"String"},ft_ent_identifier:{type:"StringOrPFBID"},reaction_type:{type:"Enum",enumType:0},reaction_id:{type:"String"},story_render_location:{type:"Enum",enumType:1},is_inline:{type:"Bool",defaultValue:!1},is_comment:{type:"Bool",defaultValue:!1},is_permalink:{type:"Bool",defaultValue:!1},action_source:{type:"String"},feedback_source:{type:"Int"},feedback_referrer:{type:"String"},is_sponsored:{type:"Bool",defaultValue:!1},basic_origin_uri:{type:"String"},basic_reload:{type:"Exists",defaultValue:!1},bgsync_id:{type:"String"},aftercursor:{type:"String"},tab:{type:"String"},_ft_:{type:"String"}})}),null);
__d("UFIReactionUserActions",["ActorURI","AsyncResponse","ChannelClientID","ClientIDs","MercuryServerDispatcher","NumberFormat","QE2Logger","UFICentralUpdates","UFICommentAction","UFIComments","UFIConfig","UFIConstants","UFIFeedbackTargets","UFIReactionPendingRequestsStore","UFIReactionSyncStore","UFIReactionTypes","UFIReactionsUtils","UFISharedDispatcher","UFIStoryAction","UFIUserActionUtils","UFIVideoPlayerRegistry","XUFICommentReactionController","XUFIReactionController","ifRequired","setImmediate"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f,g,h){g===void 0&&(g=null),h===void 0&&(h=null),d("UFIFeedbackTargets").getFeedbackTarget(a,function(i){var j=s(i,b);c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:j});j=d("UFIUserActionUtils").trackingData(f);var k={};k[d("ActorURI").PARAMETER_ACTOR]=i.actorforpost;var l=babelHelpers["extends"]({client_id:d("ClientIDs").getNewClientID(),ft_ent_identifier:a,reaction_type:b,root_id:e.rootid,session_id:d("ChannelClientID").getID(),source:e.source,feedback_referrer:e.feedbackReferrer,instance_id:e.instanceid},k,j);if(e.fluentContentToken){i=e.fluentContentToken;var m=d("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerForElement(f,i);m&&m.isSpherical()&&(l.video_playback_timestamp=d("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerTimeForElement(f,i));e.isLiveVOD?l.on_demand_content_time_offset=d("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerTimeForElement(f,i):e.islivestreaming&&(l.live_content_time_offset=d("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerTimeForElement(f,i));m&&m.isSpherical()&&c("ifRequired")("SphericalViewportControlStore",function(a){a=a.getOrientation(m.getVideoPlayerID());a&&(g!==null&&h!==null?(l.spherical_yaw=g,l.spherical_pitch=h):(l.spherical_pitch=Math.round(a.pitch),l.spherical_yaw=Math.round(a.yaw)))})}d("MercuryServerDispatcher").trySend(c("XUFIReactionController").getURIBuilder().getURI(),l)})}function b(a,b,e,f){var g=d("UFIComments").getComment(a);g&&g.__typename==="saved"&&g.viewerreaction!=b&&d("UFIFeedbackTargets").getFeedbackTarget(g.ftentidentifier,function(h){var i=d("UFIUserActionUtils").trackingData(f),j=r(g,h,b);c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:j});j={};j[d("ActorURI").PARAMETER_ACTOR]=h.actorforpost;d("MercuryServerDispatcher").trySend(c("XUFICommentReactionController").getURIBuilder().getURI(),babelHelpers["extends"]({comment_id:a,legacy_id:g.legacyid,reaction_type:b,ft_ent_identifier:g.ftentidentifier,source:e.source,instance_id:e.instanceid,client_id:d("ClientIDs").getNewClientID(),session_id:d("ChannelClientID").getID()},i,j))})}var h={},i=c("XUFIReactionController").getURIBuilder().getURI();h[i]={mode:d("MercuryServerDispatcher").IMMEDIATE,error_handler:n,handler:m};i=c("XUFICommentReactionController").getURIBuilder().getURI();h[i]={mode:d("MercuryServerDispatcher").BATCH_CONDITIONAL,batch_if:e,batch_function:f,error_handler:q,handler:p};d("MercuryServerDispatcher").registerEndpoints(h);function e(a,b){return a&&a.ft_ent_identifier==b.ft_ent_identifier&&a.comment_id==b.comment_id}function f(a,b){return b}var j="feedback_reactions_www_rollback_universe";function k(){d("QE2Logger").logExposureForUser(j)}function l(a,b){var e=c("UFIReactionPendingRequestsStore").getPendingRequests(a);if(e>0)return;var f=c("UFIReactionSyncStore").getLastKnownReaction(a);if(b===f)return;d("UFIFeedbackTargets").getFeedbackTarget(a,function(a){a=s(a,f);c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:a})})}function m(a,b){a=b.data;var e=a.ft_ent_identifier,f=a.reaction_type;c("UFISharedDispatcher").dispatch(d("UFIStoryAction").changeReactionSuccess({instanceid:a.instance_id,ftentidentifier:e},f));c("setImmediate")(function(){return l(e,f)})}function n(a){var b=a.request.data,e=b.ft_ent_identifier,f=b.reaction_type;k();var g=c("UFIConfig").reactionsHasReactionsRollback,h=c("UFIConfig").reactionsHasReactionsRetry;if(h&&!b.retry_attempt){d("MercuryServerDispatcher").trySend(c("XUFIReactionController").getURIBuilder().getURI(),babelHelpers["extends"]({},b,{retry_attempt:1}));return}c("UFISharedDispatcher").dispatch(d("UFIStoryAction").changeReactionFailure({instanceid:b.instance_id,ftentidentifier:e},f));g&&c("setImmediate")(function(){return l(e,f)});c("AsyncResponse").defaultErrorHandler(a)}function o(a,b,e){var f=c("UFIReactionPendingRequestsStore").getPendingRequestsForComment(b.fbid);if(f>0)return;var g=c("UFIReactionSyncStore").getLastKnownCommentReaction(b.fbid);if(e===g)return;d("UFIFeedbackTargets").getFeedbackTarget(a,function(a){a=r(b,a,g);c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:a})})}function p(a,b){a=b.data;var e=a.ft_ent_identifier,f=a.reaction_type,g=d("UFIComments").getComment(a.comment_id);if(!g||g.__typename!=="saved")return;c("UFISharedDispatcher").dispatch(d("UFICommentAction").changeReactionSuccess({instanceid:a.instance_id,ftentidentifier:e},g,f));c("setImmediate")(function(){return o(e,g,f)})}function q(a){var b=a.request.data,e=b.ft_ent_identifier,f=b.reaction_type,g=d("UFIComments").getComment(b.comment_id);if(!g)return;k();var h=c("UFIConfig").reactionsHasCommentReactionsRollback,i=c("UFIConfig").reactionsHasCommentReactionsRetry;if(i&&!b.retry_attempt){d("MercuryServerDispatcher").trySend(c("XUFICommentReactionController").getURIBuilder().getURI(),babelHelpers["extends"]({},b,{retry_attempt:1}));return}g&&g.__typename==="saved"&&(c("UFISharedDispatcher").dispatch(d("UFICommentAction").changeReactionFailure({instanceid:b.instance_id,ftentidentifier:e},g,f)),h&&c("setImmediate")(function(){return o(e,g,f)}));c("AsyncResponse").defaultErrorHandler(a)}function r(a,b,e){var f=a.id,g=[u(a,e,f,b.supportedreactions||[],b.actorforpost)];e=e===c("UFIReactionTypes").LIKE;if(b.hasviewerliked!==e){b=e?1:-1;g.push({commentid:f,actiontype:d("UFIConstants").UFIActionType.COMMENT_LIKE,viewerliked:e,likecount:(a.likecount||0)+b})}return g}function s(a,b){var e=[t(a,b)];b=b!==c("UFIReactionTypes").NONE;if(a.hasviewerliked!==b){var f=b?1:-1;e.push({actiontype:d("UFIConstants").UFIActionType.LIKE_ACTION,actorid:a.actorforpost,hasviewerliked:b,likecount:(a.likecount||0)+f,entidentifier:a.entidentifier,likesentences:{current:a.likesentences.alternate,alternate:a.likesentences.current}})}return e}function t(a,b){return babelHelpers["extends"]({actiontype:d("UFIConstants").UFIActionType.REACTION,actorid:a.actorforpost,entidentifier:a.entidentifier},d("UFIReactionsUtils").getReactionData(a,b,a.actorforpost,d("NumberFormat").formatInteger))}function u(a,b,c,e,f){var g={};for(var h=0;h<e.length;h++){var i=e[h],j=a.reactioncountmap?a.reactioncountmap[i]:null;g[i]={"default":j?j["default"]:0,reduced:j?j.reduced:"0"}}i=d("UFIReactionsUtils").getReactionData({viewerreaction:a.viewerreaction,reactioncount:a.reactioncount,reactioncountreduced:a.reactioncountreduced,reactioncountmap:g,reactorids:a.viewerreaction?[f]:[]},b,f);return{actiontype:d("UFIConstants").UFIActionType.COMMENT_REACTION,commentid:c,hasviewerliked:!!b,likecount:i.reactioncountmap[1]["default"],reactioncount:i.reactioncount,reactioncountmap:i.reactioncountmap,reactioncountreduced:i.reactioncountreduced,viewerreaction:b}}g.changeReaction=a;g.changeCommentReaction=b}),98);
__d("UFIReplyCommentList",["UFICentralUpdates","UFIComments","UFIConstants","UFIReplyCommentListImpl","getObjectValues"],(function(a,b,c,d,e,f,g){"use strict";var h={};function i(a,b,d){h[b]||(h[b]={});if(!h[b][d]){a=new(c("UFIReplyCommentListImpl"))(a,b,d);var e=j(String(b));e.length&&a.updateCommentCount(e[0].getCommentCount());h[b][d]=a}return h[b][d]}function j(a){return c("getObjectValues")(h[a]||{})}function a(a,b,c,d){a=(h[b]||{})[d];if(!a)return;a.reset();a.actorID=c}function k(a){a=d("UFIComments").getComment(a.commentid);if(!a)return;var b=a.id,c=a.parentcommentid;if(!c)return;a.status!==d("UFIConstants").UFIStatus.DELETED&&a.status!==d("UFIConstants").UFIStatus.FAILED_ADD&&j(c).forEach(function(a){a.deleteComment(b)})}c("UFICentralUpdates").subscribe("update-actions",function(a,b){if(b.actions&&b.actions.length)for(var a=0;a<b.actions.length;a++){var c=b.actions[a];switch(c.actiontype){case d("UFIConstants").UFIActionType.DELETE_COMMENT:k(c);break}}});c("UFICentralUpdates").subscribe("update-comment-lists",function(a,b){a=b.commentlists;if(a&&a.replies&&Object.keys(a).length)for(var b in a.replies){var c=a.replies[b],d=c.ftentidentifier,e=c.containerorderingmode;d=i(String(d),String(b),e);d.addCommentIDs(c.range.offset,c.range.length,c.values);d.updateCommentCount(c.count)}});c("UFICentralUpdates").subscribe("update-comments",function(a,b){(b.comments||[]).concat(b.privatecomments||[]).concat(b.authorpinnedcomments||[]).forEach(function(a){var b=a.parentcommentid;if(!b)return;j(String(b)).forEach(function(b){b.addOrUpdateComment(a)})})});g.getCommentList=i;g.getReplyListsForParentCommentID=j;g.resetWithContext=a}),102);
__d("UFIThreadedFacecastCommentsStore",["FluxReduceStore","UFIComments","UFIDispatcherBase"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=c=a.call.apply(a,[this].concat(f))||this,c.reduce=function(a,b){switch(b.type){case"story_show_facecast_replies":var e;return babelHelpers["extends"]({},a,(e={},e[b.instanceID]={comment_id:b.commentID,reply_comment_ids:c.getReplyCommentIDs(b.instanceID),is_loaded:!1},e));case"story_hide_facecast_replies":return babelHelpers["extends"]({},a,(e={},e[b.instanceID]={comment_id:null,reply_comment_ids:[],is_loaded:!1},e));case"story_add_facecast_reply":if(c.getCommentID(b.instanceID)===null)return a;e=b.replyCommentID;var f=c.getReplyCommentIDs(b.instanceID);f.indexOf(e)===-1&&(f=f.slice(0),f.push(e));return babelHelpers["extends"]({},a,(e={},e[b.instanceID]={comment_id:c.getCommentID(b.instanceID),reply_comment_ids:f,is_loaded:c.getIsLoaded(b.instanceID)},e));case"story_add_facecast_replies":if(c.getCommentID(b.instanceID)===null)return a;var g=c.getReplyCommentIDs(b.instanceID);f=b.replyCommentIDs.filter(function(a){return g.indexOf(a)===-1});f.length!==0&&(g=g.concat(f));return babelHelpers["extends"]({},a,(e={},e[b.instanceID]={comment_id:c.getCommentID(b.instanceID),reply_comment_ids:g,is_loaded:c.getIsLoaded(b.instanceID)},e));case"facecast_replies_loaded":f=c.getCommentID(b.instanceID);return f!==b.commentID?a:babelHelpers["extends"]({},a,(e={},e[b.instanceID]={comment_id:c.getCommentID(b.instanceID),reply_comment_ids:c.getReplyCommentIDs(b.instanceID),is_loaded:!0},e));case"story_comments_arrived":if(b.source!==1||b.liveVideoCommentPermalinkID==null)return a;f=d("UFIComments").getComment(b.liveVideoCommentPermalinkID);return f==null?a:babelHelpers["extends"]({},a,(e={},e[b.instanceID]={comment_id:f.parentcommentid||f.id,reply_comment_ids:c.getReplyCommentIDs(b.instanceID),is_loaded:c.getIsLoaded(b.instanceID)},e));case"CENTRALUPDATES_SAVED_COMMENT":f=c.getReplyCommentIDs(b.instanceID);if(f.length===0)return a;e=f.indexOf(b.clientID);if(e===-1)return a;f.slice(0)[e]=b.commentID;return babelHelpers["extends"]({},a,(e={},e[b.instanceID]={comment_id:c.getCommentID(b.instanceID),reply_comment_ids:f,is_loaded:c.getIsLoaded(b.instanceID)},e));default:return a}},b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.getInitialState=function(){return{}};c.getCommentID=function(a){a=this.getState()[a];return!a?null:a.comment_id};c.getReplyCommentIDs=function(a){a=this.getState()[a];return!a?[]:a.reply_comment_ids};c.getIsLoaded=function(a){a=this.getState()[a];return!a?!1:a.is_loaded};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFIToplevelPagedCommentList",["UFICentralUpdates","UFIComments","UFIConstants","UFIReplyCommentList","UFIToplevelPagedCommentListImpl","UFIToplevelStreamedCommentList","forEachObject"],(function(a,b,c,d,e,f,g){"use strict";var h={};function i(a,b,d){d=d||"default";h[a]||(h[a]={});h[a][d]||(h[a][d]={});if(!h[a][d][b]){var e=new(c("UFIToplevelPagedCommentListImpl"))(a,b,d),f=j(a,d);f.length&&e.updateCommentCount(f[0].getCommentCount());h[a][d][b]=e}return h[a][d][b]}function a(a){var b=[];c("forEachObject")(h[a]||{},function(a){c("forEachObject")(a,function(a){b.push(a)})});return b}function j(a,b){var c=[];a=(h[a]||{})[b]||{};for(var b in a)c.push(a[b]);return c}function b(a,b){a=j(a,b);return a.length?a[0].getCommentCount():null}function e(a){var b=j(a,"default");b=b.length?b[0].getDisplayedCommentCount():null;a=c("UFIToplevelStreamedCommentList").getAllExistingCommentLists(a);a=a.length?a[0].getDisplayedCommentCount():null;return b===null&&a===null?null:Math.max(b||0,a||0)}function f(a){a=h[a];if(!a)return;var b={};for(var c in a){var e=a[c];for(var f in e){var g=e[f];g=g.reset();for(var i in g){var j=g[i];b[j]=!0}}}d("UFIComments").resetComments(b)}function k(a,b){var c=h[a];if(!c)return;var e={};for(var f in c){var g=c[f];for(var i in g){var j=g[i];j.actorID=b;j=j.reset();for(var k in j){var l=j[k];e[l]=!0;d("UFIReplyCommentList").resetWithContext(a,l,b,i)}}}d("UFIComments").resetComments(e)}function l(a){var b=d("UFIComments").getComment(a.commentid);if(!b)return;var c=b.id,e=b.ftentidentifier,f=b.parentcommentid;if(f)return;f="default";(b.privacy_value===2||b.privacy_value===3)&&h[e]&&h[e].friends&&(f="friends");(a.islocal||b.status!==d("UFIConstants").UFIStatus.DELETED&&b.status!==d("UFIConstants").UFIStatus.FAILED_ADD)&&j(e,f).forEach(function(a){a.deleteComment(c)})}function m(a,b){c("forEachObject")(a,function(a,d){c("forEachObject")(a,function(a,c){c=i(d,c,b);c.addCommentIDs(a.range.offset,a.range.length,a.values);c.setClientHasAll(!!a.clienthasall);typeof a.count==="number"&&a.count!==c.getCommentCount()&&c.updateCommentCount(a.count)})})}function n(a,b){a.forEach(function(a){if(a.parentcommentid)return;var c=a.ftentidentifier;j(c,b).forEach(function(b){b.addOrUpdateComment(a)})})}c("UFICentralUpdates").subscribe("update-actions",function(a,b){if(b.actions&&b.actions.length)for(var a=0;a<b.actions.length;a++){var c=b.actions[a];switch(c.actiontype){case d("UFIConstants").UFIActionType.DELETE_COMMENT:l(c);break}}});c("UFICentralUpdates").subscribe("update-comment-lists",function(a,b){a=b.commentlists;b=b.privatecommentlists;a&&a.comments&&m(a.comments,"default");b&&b.comments&&m(b.comments,"friends")});c("UFICentralUpdates").subscribe("update-comments",function(a,b){a=b.comments;var c=b.privatecomments;b=b.authorpinnedcomments;a&&a.length&&n(a,"default");c&&c.length&&n(c,"friends");b&&b.length&&n(b,"default")});c("UFICentralUpdates").subscribe("update-feedback",function(a,b){var c=b.feedbacktarget?b.feedbacktarget:b.feedbacktargets&&b.feedbacktargets[0];if(c){var d=c.entidentifier;a=c.defaultcommentorderingmode;var e=new Set();a&&e.add(a);c.orderingmodes&&c.orderingmodes.forEach(function(a){if(a.value==="live_streaming")return;e.add(a.value)});b=c.privatecommentcount;e.forEach(function(a){i(d,a,"default").updateCommentCount(c.commentcount)});typeof b==="number"&&i(d,"toplevel","friends").updateCommentCount(b)}});g.getCommentList=i;g.getAllCommentListsForFeedbackTargetID=a;g.getSectionedCommentListsForFeedbackTargetID=j;g.getPagedCommentCountForFeedbackTargetID=b;g.getDisplayedCommentCountForFeedbackTargetID_UNSAFE=e;g.resetCommentListsForFeedbackTargetID=f;g.resetCommentListsWithContext=k}),102);
__d("UFIRange",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){a===void 0&&(a=0),b===void 0&&(b=0),this.offset=a,this.length=b,this.requestedOffset=this.offset,this.requestedLength=this.length}var b=a.prototype;b.getOffset=function(){return this.offset};b.getLength=function(){return this.length};b.getRequestedOffset=function(){return this.requestedOffset};b.getRequestedLength=function(){return this.requestedLength};b.updateRequestedRange=function(a,b){this.requestedOffset=a;this.requestedLength=b;return this};b.isLoadingNext=function(){var a=this.requestedOffset+this.requestedLength,b=this.offset+this.length;return a>b};b.isLoadingPrev=function(){return this.requestedOffset<this.offset};a.combine=function(b,c){if(!c)return b;var d=Math.min(b.getOffset(),c.getOffset());b=Math.max(b.getLength(),c.getLength());var e=new a(d,b);if(c.getRequestedLength()>0){var f=Math.min(d,c.getRequestedOffset());d=Math.max(d+b,c.getRequestedOffset()+c.getRequestedLength());e.updateRequestedRange(f,d-f)}return e};return a}();f["default"]=a}),66);
__d("UFIToplevelStreamedCommentList",["invariant","ClientIDs","LiveVideoUFIConfig","UFICentralUpdates","UFICommentLogger","UFIComments","UFIConfig","UFIConstants","UFIRange","UFIThreadedFacecastCommentsStore","objectValues"],(function(a,b,c,d,e,f,g,h){"use strict";var i=function(){function a(a){this.feedbackTargetID=a,this.commentIDs=[],this.deletedCount=0,this.totalCommentCount=0,this.addedCommentCountForUnseenCounter=0}var b=a.prototype;b.getFeedbackTargetID=function(){return this.feedbackTargetID};b.getClientHasAll=function(){return!1};b.getActualCommentCount=function(){return this.commentIDs.length};b.getCommentCount=function(){return this.totalCommentCount};b.getAddedCommentCountForUnseenCounter=function(){return this.addedCommentCountForUnseenCounter};b.getDisplayedCommentCount=function(){return this.getCommentCount()-this.getDeletedCount()};b.getDeletedCount=function(){return this.deletedCount};b.getPermalinkForComment=function(a){return""};b.getComments=function(a,b,d,e){e(this.getCommentsOrThrow(new(c("UFIRange"))(a,b),d))};b.getCommentsOrThrow=function(a,b){a=[a.getLength(),a.getOffset()];var c=a[0];a=a[1];a===0||h(0,2239);a=b.streamingOrderReversed;b={};for(var e=0;e<Math.min(c,this.commentIDs.length);++e){var f=a?this.commentIDs.length-1-e:e;f=d("UFIComments").getComment(this.commentIDs[f]);f&&(b[e]=f)}return b};b.$3=function(){var a=this.commentIDs;this.commentIDs=[];return a};b.hasComment=function(a){for(var b=0;b<this.commentIDs.length;++b)if(this.commentIDs[b]===a.id)return!0;return!1};b.addCommentIDs=function(a,b,c){};b.setClientHasAll=function(a){};b.addOrUpdateComment=function(a,b){b===void 0&&(b=null);var e=a.clientid;if(e&&d("ClientIDs").isExistingClientID(e))for(var f=0;f<this.commentIDs.length;++f)this.commentIDs[f]===e&&(this.commentIDs[f]=a.id,c("UFIConfig").logCommentPost&&c("UFICommentLogger").logNewCommentReceived(e,Date.now()));else if(b||a.__typename==="local"){if(this.hasComment(a))return;this.commentIDs.push(a.id);b!=="on_demand"&&!a.isAnnouncement&&!a.tipOptionIndex&&(this.totalCommentCount+=1,a.__typename!=="local"&&(c("objectValues")(c("UFIThreadedFacecastCommentsStore").getState()||{}).map(function(a){return(a=a)!=null?a.comment_id:a}).includes(a.parentcommentid)||(this.addedCommentCountForUnseenCounter+=1)))}f=c("LiveVideoUFIConfig").live_video_scrollable_comments;this.commentIDs.length>f&&this.commentIDs.shift();c("UFICentralUpdates").didUpdateFeedback(this.feedbackTargetID)};b.deleteComment=function(a){this.deletedCount+=1;var b=[];for(var c=0;c<this.commentIDs.length;++c){var e=this.commentIDs[c],f=d("UFIComments").getComment(e);e!==a&&((f=f)!=null?f.parentcommentid:f)!==a&&b.push(e)}this.commentIDs=b};b.updateCommentCount=function(a){this.totalCommentCount=a,this.deletedCount=0};a.getCommentList=function(b,c){c===void 0&&(c=a.GLOBAL_ID);var d=a.$1.get(b);d||(d=new Map(),a.$1.set(b,d));var e=d.get(c);e||(e=new a(b),d.set(c,e));return e};a.getExistingCommentList=function(b,c){c===void 0&&(c=a.GLOBAL_ID);b=a.$1.get(b);return!b?null:b.get(c)};a.getAllExistingCommentLists=function(b){b=a.$1.get(b);return!b?[]:Array.from(b.values())};a.$4=function(b,c){var d=a.$2.get(b);if(d){c.forEach(function(a){d[a]=!0});return}var e={};c.forEach(function(a){e[a]=!0});a.$2.set(b,e)};a.resetCommentList=function(b,c){c===void 0&&(c=a.GLOBAL_ID);c=a.getExistingCommentList(b,c);if(!c)return;a.$4(b,c.$3())};a.resetAllCommentLists=function(b){var c=a.getAllExistingCommentLists(b);if(c.length===0)return;c.forEach(function(c){a.$4(b,c.$3())});c=a.$2.get(b);c&&(a.$2["delete"](b),d("UFIComments").resetComments(c))};return a}();i.GLOBAL_ID="GLOBAL_ID";i.$1=new Map();i.$2=new Map();c("UFICentralUpdates").subscribe("update-actions",function(a,b){if(!b.actions)return;b.actions.forEach(function(a){if(a.actiontype!==d("UFIConstants").UFIActionType.DELETE_COMMENT)return;var b=d("UFIComments").getComment(a.commentid);if(!b)return;var c=b.id,e=b.ftentidentifier,f=b.parentcommentid;if(f)return;(a.islocal||b.status!==d("UFIConstants").UFIStatus.DELETED&&b.status!==d("UFIConstants").UFIStatus.FAILED_ADD)&&i.getAllExistingCommentLists(e).forEach(function(a){return a.deleteComment(c)})})});c("UFICentralUpdates").subscribe("update-comments",function(a,b){if(!b.comments)return;var c=b.targetufiinstanceid;b.comments.forEach(function(a){c?i.getCommentList(a.ftentidentifier,c).addOrUpdateComment(a,b.streamingstate):i.getAllExistingCommentLists(a.ftentidentifier).forEach(function(c){c.addOrUpdateComment(a,b.streamingstate)})})});g["default"]=i}),102);
__d("XTownHallController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/townhall/",{ref:{type:"Enum",enumType:1},notif_id:{type:"Int"},setting_nux:{type:"Bool",defaultValue:!1},hide_nux:{type:"Bool",defaultValue:!1},new_reps:{type:"Int"},tab:{type:"Enum",enumType:1}})}),null);
__d("XUFIActorChangeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/actor/change/",{})}),null);
__d("XUFIAddCommentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/add/comment/",{privacy_mutation_token:{type:"String"}})}),null);
__d("XUFICommentLikeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/comment/like/",{})}),null);
__d("XUFIDeleteCommentAndRemoveCommenterController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/deletecommentandremovecommenter/",{})}),null);
__d("XUFIDeleteCommentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/delete/comment/",{privacy_mutation_token:{type:"String"}})}),null);
__d("XUFIEditCommentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/edit/comment/",{privacy_mutation_token:{type:"String"}})}),null);
__d("XUFIHideCommentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/hide/comment/",{})}),null);
__d("XUFILikeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/like/",{})}),null);
__d("XUFITranslateCommentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/translate/comment/",{})}),null);
__d("UFIUserActions",["errorCode","fbt","invariant","ActorURI","AsyncResponse","Bootloader","ChannelClientID","ClientIDs","ImmutableObject","MercuryServerDispatcher","ThisControllerNoLongerExists","UFICentralUpdates","UFICommentLogger","UFICommentVoteUserActions","UFIComments","UFIConfig","UFIConstants","UFIFeedbackTargets","UFINewCommentsPillUtils","UFIReactionUserActions","UFIStoryAction","UFIToplevelPagedCommentList","UFIToplevelStreamedCommentList","UFIUserActionUtils","UFIVideoPlayerRegistry","UnicodeBidi","XGroupsMuteMembersController","XTownHallController","XUFIActorChangeController","XUFIAddCommentController","XUFICommentLikeController","XUFIDeleteCommentAndRemoveCommenterController","XUFIDeleteCommentController","XUFIEditCommentController","XUFIHideCommentController","XUFILikeController","XUFITranslateCommentController","goURI","ifRequired"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=Object.freeze({BAN:"ban",UNDO_BAN:"undo_ban"}),l={changeActor:function(a,b){d("UFIFeedbackTargets").getFeedbackTarget(a,function(e){d("UFIToplevelPagedCommentList").resetCommentListsWithContext(a,b);c("UFIToplevelStreamedCommentList").resetAllCommentLists(a);c("UFICentralUpdates").inform("actor-changed",{actorID:b});e=(e={from_actor_id:e.actorforpost,ft_ent_identifier:a},e[d("ActorURI").PARAMETER_ACTOR]=b,e);var f=c("XUFIActorChangeController").getURIBuilder().getURI();d("MercuryServerDispatcher").trySend(f,e)})},changeCommentLike:function(a,b,e){var f=d("UFIComments").getComment(a);if(f&&f.__typename==="saved"&&f.hasviewerliked!=b){var g=e.target?d("UFIUserActionUtils").trackingData(e.target):{},h=b?1:-1;h={commentid:a,actiontype:d("UFIConstants").UFIActionType.COMMENT_LIKE,viewerliked:b,likecount:(f.likecount||0)+h};c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[h]});d("UFIFeedbackTargets").getFeedbackTarget(f.ftentidentifier,function(h){var i={};i[d("ActorURI").PARAMETER_ACTOR]=h.actorforpost;h=c("XUFICommentLikeController").getURIBuilder().getURI();d("MercuryServerDispatcher").trySend(h,babelHelpers["extends"]({comment_id:a,legacy_id:f.legacyid,like_action:b,ft_ent_identifier:f.ftentidentifier,source:e.source,client_id:d("ClientIDs").getNewClientID(),session_id:d("ChannelClientID").getID()},g,i))})}},_getAttachment:function(a){return a},_getLocalComment:function(a,b,c,e,f,g){e=d("ClientIDs").getNewClientID();var h=d("UnicodeBidi").isDirectionLTR(c)?"ltr":"rtl",j=l._getAttachment(f.attachedsticker),k=f.replyid,m=null;if(k!=null){k=d("UFIComments").getComment(k);m=k!=null?k.author:null}return{__typename:"local",ftentidentifier:b,body:{text:c,dir:h},author:a.actorforpost,cancomment:!1,clientid:null,fbid:null,id:e,ufiinstanceid:f.ufiinstanceid,likecount:0,hasviewerliked:!1,parentcommentid:f.replyid,parentcommentauthorid:m,replycommentparentid:f.replycommentparentid,attachment:j,photo_comment:f.attachedphoto,video_comment:f.attachedvideo,file_comment:f.attachedfile,timestamp:{time:Math.floor(Date.now()/1e3),text:i._(/*FBT_CALL*/"v\u00e0i gi\u00e2y tr\u01b0\u1edbc"/*FBT_CALL*/)},photoTextTagID:f.photoTextTagID,isPhotoTag:f.isPhotoTag,photoTagX:f.photoTagX,photoTagY:f.photoTagY,privacy_value:f.privacyValue,videoTimeOffset:g,postedLiveState:f.islivestreaming?"Live":"OnDemand",trackingID:f.trackingID,voteEnabled:!1,voteCount:0,voteState:d("UFIConstants").UFICommentVoteType.NONE}},addComment:function(a,b,e,f){d("UFIFeedbackTargets").getFeedbackTarget(a,function(g){var h=l.createComment(a,b,e,f);if(!h)return;var i={actiontype:d("UFIConstants").UFIActionType.SUBSCRIBE_ACTION,actorid:g.actorforpost,hasviewersubscribed:!0,entidentifier:g.entidentifier};g={actiontype:d("UFIConstants").UFIActionType.ADD_COMMENT_ACTION,feedbackfbid:g.targetfbid};var j=[],k=[];(h.privacy_value===2||h.privacy_value===3?k:j).push(h);c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{comments:j,privatecomments:k,actions:[i,g]});if(h.parentcommentid&&(f.islivestreaming||f.isLiveVOD)&&f.ufiinstanceid!=null){j={ftentidentifier:a,instanceid:f.ufiinstanceid};d("UFINewCommentsPillUtils").dispatchNewCommentAction(d("UFIStoryAction").handleNewFacecastReply(j,h.id),j)}})},createComment:function(a,b,e,f){var g=d("UFIFeedbackTargets").getFeedbackTargetIfExists(a);if(!(g&&g.actorforpost))return null;var h=null;if(f.isBroadcasterUFI)h=c("ifRequired")("LiveVideoBroadcastBroadcastStore",function(a){return a.getCurrentBroadcastTime()});else if(f.fluentContentToken&&(f.isLiveVOD||f.islivestreaming||f.enableVODCommentTimestamps)){var i=d("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerTimeForElement(f.target,f.fluentContentToken)||0;if(f.isLiveVOD||f.islivestreaming)h=i;else{var j=d("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerForElement(f.target,f.fluentContentToken);j!=null&&i>0&&i<Math.floor(j.getPlaybackDuration())&&(h=i)}}j=l._getLocalComment(g,a,b,e,f,h);l._sendCommentToServer(a,g.actorforpost,b,e,f,j.id,h);return j},_sendCommentToServer:function(a,b,e,f,g,h,i){e=null;if(g.reply_fbid)e=g.reply_fbid;else if(g.replyid){var k=d("UFIComments").getComment(g.replyid);k||j(0,199);e=k.fbid}var l;d("UFIConfig").logCommentPost&&c("UFICommentLogger").logNewCommentPost(h,g.timestamp||0,{has_photo:!!g.attachedphoto,has_video:!!g.attachedvideo,has_file:!!g.attachedfile,has_sticker:!!g.attachedsticker,is_reply:!!g.replyid});k={};g.liveVideoQuickCommentQuality!=null&&(k={live_video_quick_comment_quality:g.liveVideoQuickCommentQuality});var m={};m[d("ActorURI").PARAMETER_ACTOR]=b;b=c("XUFIAddCommentController").getURIBuilder().getURI();d("MercuryServerDispatcher").trySend(b,babelHelpers["extends"]({ft_ent_identifier:a,comment_text:f,source:g.source,client_id:h,session_id:d("ChannelClientID").getID(),reply_fbid:e,parent_comment_id:g.parent_comment_id||g.replyid,reply_comment_parent_id:g.replycommentparentid,rootid:g.rootid,clp:l,attached_sticker_fbid:g.attachedsticker?g.attachedsticker.fbid:null,attached_photo_fbid:g.attachedphoto?g.attachedphoto.fbid:null,attached_video_fbid:g.attachedvideo?g.attachedvideo.fbid:null,attached_file_fbid:g.attachedfile?g.attachedfile.fbid:null,attached_share_url:g.attachedshareurl,feedback_referrer:g.feedbackReferrer,feed_context:g.feedcontext,video_time_offset:i,is_live_streaming:g.islivestreaming,is_markdown:g.isMarkdown},d("UFIUserActionUtils").trackingData(g.target),m,{photo_text_tag_id:g.photoTextTagID,is_photo_tag:g.isPhotoTag,photo_fbid:g.photoFBID,photo_tag_x:g.photoTagX,photo_tag_y:g.photoTagY,privacy_value:g.privacyValue,delight_ranges:g.delightRanges},k))},_hasCommentTextChanged:function(a,b){return!!a.body&&a.body.text!=b},_hasCommentPhotoChanged:function(a,b){return!!((a||b)&&!(a&&b)||a&&b&&a.fbid!=b.fbid)},_hasCommentVideoChanged:function(a,b){return!!((a||b)&&!(a&&b)||a&&b&&a.fbid!=b.fbid)},_hasCommentFileChanged:function(a,b){return!!((a||b)&&!(a&&b)||a&&b&&a.fbid!=b.fbid)},_hasCommentStickerChanged:function(a,b){return!!((a||b)&&!(a&&b)||a&&a.type=="sticker"&&b&&a.fbid!=b.fbid)},_hasCommentShareURLChanged:function(a,b){if(b)return!0;else return Boolean(a&&a.type=="share")},editComment:function(a,b,e,f){var g=d("UFIUserActionUtils").trackingData(f.target),h=d("UFIComments").getComment(a);if(!h)return;a=l._hasCommentTextChanged(h,b)||l._hasCommentPhotoChanged(h.photo_comment,f.attachedPhoto)||l._hasCommentStickerChanged(h.attachment,f.attachedSticker)||l._hasCommentVideoChanged(h.video_comment,f.attachedVideo)||l._hasCommentFileChanged(h.file_comment,f.attachedFile)||l._hasCommentShareURLChanged(h.attachment,f.attachedShareURL);h=c("ImmutableObject").set(h,{status:d("UFIConstants").UFIStatus.PENDING_EDIT,body:{text:b},editnux:null,attachment:f.attachedSticker,photo_comment:f.attachedPhoto,video_comment:f.attachedVideo,file_comment:f.attachedFile});a&&(h=c("ImmutableObject").set(h,{originalTimestamp:h.timestamp.time,timestamp:{time:Math.floor(Date.now()/1e3),text:i._(/*FBT_CALL*/"v\u00e0i gi\u00e2y tr\u01b0\u1edbc"/*FBT_CALL*/)}}));c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{comments:[h]});d("UFIFeedbackTargets").getFeedbackTarget(h.ftentidentifier,function(a){var b={};b[d("ActorURI").PARAMETER_ACTOR]=a.actorforpost;a=c("XUFIEditCommentController").getURIBuilder().getURI();h&&d("MercuryServerDispatcher").trySend(a,babelHelpers["extends"]({ft_ent_identifier:h.ftentidentifier,comment_text:e,source:f.source,comment_id:h.id,parent_comment_id:h.parentcommentid,attached_sticker_fbid:f.attachedSticker?f.attachedSticker.fbid:0,attached_photo_fbid:f.attachedPhoto?f.attachedPhoto.fbid:0,attached_video_fbid:f.attachedVideo?f.attachedVideo.fbid:0,attached_file_fbid:f.attachedFile?f.attachedFile.fbid:0,attached_share_url:f.attachedShareURL,is_markdown:f.isMarkdown,delight_ranges:f.delightRanges},g,b))})},translateComments:function(a,b,e,f){var g=c("XUFITranslateCommentController").getURIBuilder().getURI();d("MercuryServerDispatcher").trySend(g,{ft_ent_identifier:a,comment_ids:b,source:f.source,trigger:e})},setHideAsSpam:function(a,b,e){var f=d("UFIUserActionUtils").trackingData(e.target),g=d("UFIComments").getComment(a),h={commentid:a,actiontype:d("UFIConstants").UFIActionType.COMMENT_SET_SPAM,shouldHideAsSpam:b};c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[h]});g&&d("UFIFeedbackTargets").getFeedbackTarget(g.ftentidentifier,function(h){var i={};i[d("ActorURI").PARAMETER_ACTOR]=h.actorforpost;h=c("XUFIHideCommentController").getURIBuilder().getURI();d("MercuryServerDispatcher").trySend(h,babelHelpers["extends"]({comment_id:a,spam_action:b,ft_ent_identifier:g.ftentidentifier,source:e.source},f,i))})},removeComment:function(a,b,e){var f=d("UFIUserActionUtils").trackingData(b.target),g=d("UFIComments").getComment(a);a={actiontype:d("UFIConstants").UFIActionType.DELETE_COMMENT,commentid:a,islocal:!0,oneclick:b.oneclick};c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[a]});g&&g.__typename==="saved"&&d("UFIFeedbackTargets").getFeedbackTarget(g.ftentidentifier,function(a){var h={};h[d("ActorURI").PARAMETER_ACTOR]=a.actorforpost;a=c("XUFIDeleteCommentController").getURIBuilder().getURI();d("MercuryServerDispatcher").trySend(a,babelHelpers["extends"]({comment_id:g.id,comment_legacyid:g.legacyid,ft_ent_identifier:g.ftentidentifier,one_click:b.oneclick,source:b.source,block_author:e,client_id:d("ClientIDs").getNewClientID()},f,h))})},deleteCommentAndRemoveCommenter:function(a,b,e,f,g,h,i){var j=d("UFIUserActionUtils").trackingData(b.target),k=d("UFIComments").getComment(a);a={actiontype:d("UFIConstants").UFIActionType.DELETE_COMMENT_REMOVE_COMMENTER,commentid:a,islocal:!0,oneclick:b.oneclick};c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[a]});k&&k.__typename==="saved"&&d("UFIFeedbackTargets").getFeedbackTarget(k.ftentidentifier,function(a){var l={};l[d("ActorURI").PARAMETER_ACTOR]=a.actorforpost;a=c("XUFIDeleteCommentAndRemoveCommenterController").getURIBuilder().getURI();d("MercuryServerDispatcher").trySend(a,babelHelpers["extends"]({comment_id:k.id,comment_legacyid:k.legacyid,ft_ent_identifier:k.ftentidentifier,one_click:b.oneclick,source:b.source,delete_posts:e,delete_comments:f,decline_pending_members:g,block_permanently:h,apply_to_other_groups:i,client_id:d("ClientIDs").getNewClientID()},j,l))})},muteMember:function(a,b,e,f){b=d("UFIComments").getComment(a);a=e!==null;if(b&&b.__typename==="saved"){a={authorid:b.author,actiontype:d("UFIConstants").UFIActionType.MUTE_MEMBER,shouldmute:a};c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[a]});var g;c("Bootloader").loadModules(["GroupMemberActionSource"],function(a){g=a.GROUP_COMMENT},"UFIUserActions");a=c("XGroupsMuteMembersController").getURIBuilder().getURI();d("MercuryServerDispatcher").trySend(a,{group_id:b.group_id,user_id:b.author,mute_duration:e,custom_expiration:f,should_reload:!1,source:g})}},toggleTextDelights:function(a,b,c){var e=d("ThisControllerNoLongerExists").__DEADURI__("s3xbblpdp");d("MercuryServerDispatcher").trySend(e,{comment_id:a.id,ft_ent_identifier:a.ftentidentifier,should_hide:c,parent_comment_id:a.parentcommentid,source:b.source})},banUser:function(a,b,c,e){e=c?k.BAN:k.UNDO_BAN;d("MercuryServerDispatcher").trySend("/ajax/ufi/ban_user.php",{page_id:b,commenter_id:a.author,action:e,comment_id:a.id,client_side:!0,post_only:!1})},streamBanUser:function(a,b,c,e){e=c?k.BAN:k.UNDO_BAN;d("MercuryServerDispatcher").trySend("/ajax/ufi/ban_user.php",{page_id:b,commenter_id:a.author,action:e,comment_id:a.id,client_side:!0,stream_only:!0})},suspendUser:function(a,b,c,e,f){f=c?k.BAN:k.UNDO_BAN;d("MercuryServerDispatcher").trySend("/ajax/ufi/ban_user.php",{page_id:b,commenter_id:a.author,action:f,comment_id:a.id,suspension_duration_seconds:e,client_side:!0})},changeSubscribe:function(a,b,e){d("UFIFeedbackTargets").getFeedbackTarget(a,function(f){var g=d("UFIUserActionUtils").trackingData(e.target);if(f.hasviewersubscribed!==b){var h={actiontype:d("UFIConstants").UFIActionType.SUBSCRIBE_ACTION,actorid:f.actorforpost,hasviewersubscribed:b,entidentifier:a};c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[h]});h={};h[d("ActorURI").PARAMETER_ACTOR]=f.actorforpost;d("MercuryServerDispatcher").trySend("/ajax/ufi/subscribe.php",babelHelpers["extends"]({subscribe_action:b,ft_ent_identifier:a,source:e.source,client_id:d("ClientIDs").getNewClientID(),rootid:e.rootid,comment_expand_mode:e.commentexpandmode},g,h))}})},changeSubscribeWithLogging:function(a,b){d("UFIFeedbackTargets").getFeedbackTarget(a,function(e){if(e.hasviewersubscribed!==b){e={actiontype:d("UFIConstants").UFIActionType.SUBSCRIBE_ACTION,actorid:e.actorforpost,hasviewersubscribed:b,entidentifier:a};c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[e]});d("MercuryServerDispatcher").trySend("/ajax/litestand/follow_post",{follow:b,message_id:a})}})},fetchSpamComments:function(a,b,c,e){d("MercuryServerDispatcher").trySend("/ajax/ufi/id_comment_fetch.php",{ft_ent_identifier:a,viewas:e,comment_ids:b,parent_comment_id:c,source:null})},manageConstituentBadge:function(a){c("goURI")(c("XTownHallController").getURIBuilder().setBool("setting_nux",!0).getURI())},authorPinComment:function(a,b){d("MercuryServerDispatcher").trySend(o,{comment_id:a.id,ft_ent_identifier:a.ftentidentifier,is_pinned_by_author:b});var e={commentid:a.id,pinnedByAuthor:b,actiontype:"comment_change_author_pin"};a=d("UFIComments").getComment(a.id);if(!a)return;a=c("ImmutableObject").set(a,{ispinnedbyauthor:b});c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{comments:[a],actions:[e]})},removePreview:function(a,b){var e=d("UFIUserActionUtils").trackingData(b.target),f={commentid:a.id,actiontype:d("UFIConstants").UFIActionType.REMOVE_PREVIEW};c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[f]});d("MercuryServerDispatcher").trySend("/ajax/ufi/remove_preview.php",babelHelpers["extends"]({comment_id:a.id,ft_ent_identifier:a.ftentidentifier,source:b.source},e))}};function a(a){c("AsyncResponse").defaultErrorHandler(a)}function b(a){var b=a.request.data;c("AsyncResponse").defaultErrorHandler(a);var e=b.client_id||b.comment_id;e=d("UFIComments").getComment(e);if(!e)return;var f=e.status===d("UFIConstants").UFIStatus.PENDING_EDIT?d("UFIConstants").UFIStatus.FAILED_EDIT:d("UFIConstants").UFIStatus.FAILED_ADD;e=c("ImmutableObject").setDeep(e,{status:f,allowRetry:m(a),body:{mentionstext:b.comment_text,mentionsphoto:e.photo_comment,mentionsvideo:e.video_comment,mentionsfile:e.file_comment}});f=[];a=[];(e.privacy_value===2||e.privacy_value===3?a:f).push(e);c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{comments:f,privatecomments:a})}function m(a){var b=a.getError();if(a.isBlockedAction())return!1;if(a.silentError)return!0;return b===1357012||b===1357006?!1:!0}function e(a){a=a.request.data;a=a.comment_id;a=d("UFIComments").getComment(a);if(!a)return;a=c("ImmutableObject").set(a,{status:a.priorstatus||null,priorstatus:void 0});c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{comments:[a]})}function f(a){var b=a.request.data,e=b.comment_id,f=d("UFIComments").getComment(e);if(f&&b.like_action===f.hasviewerliked){b=f.hasviewerliked?-1:1;e={commentid:e,actiontype:d("UFIConstants").UFIActionType.COMMENT_LIKE,viewerliked:!f.hasviewerliked,likecount:(f.likecount||0)+b};c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[e]})}c("AsyncResponse").defaultErrorHandler(a)}function h(a){var b=a.request.data,e=b.ft_ent_identifier;d("UFIFeedbackTargets").getFeedbackTarget(e,function(a){if(a.hasviewerliked===b.like_action){var f=a.hasviewerliked?-1:1;f={actiontype:d("UFIConstants").UFIActionType.LIKE_ACTION,actorid:a.actorforpost,hasviewerliked:!a.hasviewerliked,likecount:(a.likecount||0)+f,entidentifier:e,likesentences:{current:a.likesentences.alternate,alternate:a.likesentences.current}};c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[f]})}});c("AsyncResponse").defaultErrorHandler(a)}function n(a){var b=a.request.data,e=b.ft_ent_identifier;d("UFIFeedbackTargets").getFeedbackTarget(e,function(a){if(a.hasviewersubscribed===b.subscribe_action){a={actiontype:d("UFIConstants").UFIActionType.SUBSCRIBE_ACTION,actorid:a.actorforpost,hasviewersubscribed:!a.hasviewersubscribed,entidentifier:e};c("UFICentralUpdates").handleUpdate(d("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[a]})}});c("AsyncResponse").defaultErrorHandler(a)}a={"/ajax/ufi/ban_user.php":{mode:d("MercuryServerDispatcher").IMMEDIATE,error_handler:a},"/ajax/ufi/subscribe.php":{mode:d("MercuryServerDispatcher").BATCH_CONDITIONAL,error_handler:n,batch_if:r,batch_function:s},"/ajax/ufi/id_comment_fetch.php":{mode:d("MercuryServerDispatcher").IMMEDIATE},"/ajax/ufi/remove_preview.php":{mode:d("MercuryServerDispatcher").IMMEDIATE},"/profile/broadcast_request/async/add_composer_token/":{mode:d("MercuryServerDispatcher").IMMEDIATE},"/ajax/litestand/follow_post":{mode:d("MercuryServerDispatcher").BATCH_CONDITIONAL,error_handler:n,batch_if:r,batch_function:s}};n=c("XUFIAddCommentController").getURIBuilder().getURI();a[n]={mode:d("MercuryServerDispatcher").IMMEDIATE,error_handler:b};r=c("XUFIDeleteCommentController").getURIBuilder().getURI();a[r]={mode:d("MercuryServerDispatcher").IMMEDIATE,error_handler:e};n=c("XUFIDeleteCommentAndRemoveCommenterController").getURIBuilder().getURI();a[n]={mode:d("MercuryServerDispatcher").IMMEDIATE,error_handler:e};r=c("XUFICommentLikeController").getURIBuilder().getURI();a[r]={mode:d("MercuryServerDispatcher").BATCH_CONDITIONAL,error_handler:f,batch_if:p,batch_function:s};n=c("XGroupsMuteMembersController").getURIBuilder().getURI();a[n]={mode:d("MercuryServerDispatcher").IMMEDIATE};r=d("ThisControllerNoLongerExists").__DEADURI__("cpl08d1cb");a[r]={mode:d("MercuryServerDispatcher").IMMEDIATE};f=c("XUFIHideCommentController").getURIBuilder().getURI();a[f]={mode:d("MercuryServerDispatcher").IMMEDIATE,error_handler:e};p=c("XUFILikeController").getURIBuilder().getURI();a[p]={mode:d("MercuryServerDispatcher").BATCH_CONDITIONAL,error_handler:h,batch_if:q,batch_function:s};n=c("XUFIEditCommentController").getURIBuilder().getURI();a[n]={mode:d("MercuryServerDispatcher").IMMEDIATE,error_handler:b};r=c("XUFITranslateCommentController").getURIBuilder().getURI();a[r]={mode:d("MercuryServerDispatcher").IMMEDIATE};f=c("XUFIActorChangeController").getURIBuilder().getURI();a[f]={mode:d("MercuryServerDispatcher").IMMEDIATE};var o=d("ThisControllerNoLongerExists").__DEADURI__("yfa5gwrzw");a[o]={mode:d("MercuryServerDispatcher").IMMEDIATE};d("MercuryServerDispatcher").registerEndpoints(a);function p(a,b){return a&&a.ft_ent_identifier==b.ft_ent_identifier&&a.comment_id==b.comment_id}function q(a,b){return a&&a.ft_ent_identifier==b.ft_ent_identifier}function r(a,b){return a&&a.ft_ent_identifier==b.ft_ent_identifier}function s(a,b){return b}e=babelHelpers["extends"]({},l,d("UFIReactionUserActions"),d("UFICommentVoteUserActions"));g["default"]=e}),98);
__d("UFICommentEditIDStore",["FluxReduceStore","UFICentralUpdates","UFIDispatcherBase"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=i(a,"string");return typeof a==="symbol"?a:String(a)}function i(a,b){if(typeof a!=="object"||a===null)return a;var c=a[typeof Symbol==="function"?Symbol.toPrimitive:"@@toPrimitive"];if(c!==void 0){c=c.call(a,b||"default");if(typeof c!=="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(b==="string"?String:Number)(a)}a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){b=a.call(this,b)||this;b.reduce=function(a,b){switch(b.type){case"PRIVATE_ACTOR_CHANGED":return{};case"add_comment_cancel":case"story_show_facecast_replies":case"story_hide_facecast_replies":case"add_comment_submit_edit":a[b.instanceID];var c=babelHelpers.objectWithoutPropertiesLoose(a,[b.instanceID].map(h));return c;case"comment_edit":return babelHelpers["extends"]({},a,(c={},c[b.instanceID]=b.comment.id,c))}return a};c("UFICentralUpdates").subscribe("actor-changed",function(a,b){c("UFIDispatcherBase").dispatch({type:"PRIVATE_ACTOR_CHANGED",instanceID:!0,ftentidentifier:!0})});return b}var d=b.prototype;d.getInitialState=function(){return{}};d.getForInstance=function(a){return this.getState()[a]||null};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFIVisibility",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({VISIBLE:"visible",HIDDEN:"hidden"});f["default"]=a}),66);
__d("UFICommentVisibilityStore",["invariant","FluxReduceStore","UFIComments","UFIDispatcherBase","UFILivePinnedCommentStore","UFIRootRegistry","UFIVisibility","filterObject"],(function(a,b,c,d,e,f,g,h){"use strict";function i(a,b){b===void 0&&(b=null);return b&&b.comment.fbid?a+"-"+b.comment.fbid+(b.isLivePinnedComment?"-P":"")+(b.isInLiveVideoReplyMode?"-R":""):a}function j(a,b){return a===b||a.startsWith(b+"-")}function k(a){a=d("UFIRootRegistry").getInstanceIDFromFTEntIdentifier(a);return a?a:[]}function l(a){return{instanceid:a}}a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,e;for(var f=arguments.length,g=new Array(f),k=0;k<f;k++)g[k]=arguments[k];return(b=e=a.call.apply(a,[this].concat(g))||this,e.reduce=function(a,b){switch(b.type){case"comment_unmounted":var e=babelHelpers["extends"]({},a);delete e[i(b.instanceID,b.renderedComment)];return e;case"comment_change_visibility":return babelHelpers["extends"]({},a,(e={},e[i(b.instanceID,b.renderedComment)]=b.visibility,e));case"story_change_visibility":e=d("UFIRootRegistry").getFTEntIdentifierFromInstanceID(b.instanceID);var f=d("UFIComments").getCommentsForFTEntIdentifier(e);b.type==="story_change_visibility"||h(0,3643);var g=b.visibility;if(f){f=f.reduce(function(a,c){a[i(b.instanceID,c.fbid?{comment:c,isLivePinnedComment:!1,isInLiveVideoReplyMode:!1}:null)]=g;return a},{});if(e){e=c("UFILivePinnedCommentStore").getPinnedCommentID(e);if(e){e=d("UFIComments").getComment(e);e&&e.__typename==="saved"&&(f[i(b.instanceID,{comment:e,isLivePinnedComment:!0,isInLiveVideoReplyMode:!1})]=g)}}return babelHelpers["extends"]({},a,(e={},e[i(b.instanceID)]=b.visibility,e),f)}case"story_remove":var k=b.instanceID,l=i(k);return c("filterObject")(a,function(a,b){return b!==l&&!j(b,k)})}return a},b)||babelHelpers.assertThisInitialized(e)}var e=b.prototype;e.getInitialState=function(){return{}};e.getVisibility=function(a,b,d){d===void 0&&(d=null);d=d?i(b.instanceid,d):i(b.instanceid);return Object.prototype.hasOwnProperty.call(a,d)?a[d]:c("UFIVisibility").HIDDEN};e.$UFICommentVisibilityStore1=function(a){a=l(a);return this.getVisibility(this.getState(),a)===c("UFIVisibility").VISIBLE};e.isFeedbackTargetVisible=function(a){var b=this;a=k(a);return a.some(function(a){return b.$UFICommentVisibilityStore1(a)})};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFILivePinnedCommentStore",["FluxReduceStore","UFIComments","UFIDispatcherBase","UFIFeedbackTargets","areEqual"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.reduce=function(a,b){var c;switch(b.type){case"story_live_pin_comment":case"story_live_unpin_comment":var d=b.commentID,e=b.pinEventID;return babelHelpers["extends"]({},a,(c={},c[b.ftentidentifier]={commentID:d,pinEventID:e},c));default:return a}},b)||babelHelpers.assertThisInitialized(c)}var e=b.prototype;e.getInitialState=function(){return{}};e.areEqual=function(a,b){return c("areEqual")(a,b)};e.getPinnedCommentID=function(a){var b=this.getState()[a];if(!b){a=d("UFIFeedbackTargets").getFeedbackTargetIfExists(a);return!a?null:a.livepinnedcommentid||null}return b.commentID||null};e.getPinEventID=function(a){a=this.getState()[a];return!a?null:a.pinEventID||null};e.getPinnedCommentAuthorID=function(a){a=this.getPinnedCommentID(a);if(!a)return null;a=d("UFIComments").getComment(a);return a?a.author||null:null};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFILocallyComposedCommentStore",["invariant","ClientIDs","FluxReduceStore","UFICentralUpdatesLocalCommentAdapter","UFIDispatcherBase","setByPath"],(function(a,b,c,d,e,f,g,h){"use strict";function i(a){return babelHelpers["extends"]({},a)}a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){b=a.call(this,b)||this;b.reduce=function(a,b){switch(b.type){case"CENTRALUPDATES_ADDED_COMMENT":d("ClientIDs").isExistingClientID(b.clientID)||h(0,3492);a=i(a);c("setByPath")(a,[b.instanceID,b.clientID],!0);return a;case"CENTRALUPDATES_SAVED_COMMENT":d("ClientIDs").isExistingClientID(b.clientID)||h(0,3492);a=i(a);c("setByPath")(a,[b.instanceID,b.commentID],!0);delete a[b.instanceID][b.clientID];return a;case"add_comment_submit_edit":a=i(a);c("setByPath")(a,[b.instanceID,b.comment.id],!0);return a}return a};d("UFICentralUpdatesLocalCommentAdapter").subscribeOnce();return b}var e=b.prototype;e.getInitialState=function(){return{}};e.getStateForInstance=function(a){return a?this.getState()[a]||{}:{}};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFISpamStore",["FluxReduceStore","UFIDispatcherBase","UFIUserActions"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=d=a.call.apply(a,[this].concat(f))||this,d.reduce=function(a,b){switch(b.type){case"story_spam_fetched":a=babelHelpers["extends"]({},a);b.commentIDs.forEach(function(b){return a[b]=!0});c("UFIUserActions").fetchSpamComments(b.ftentidentifier,b.commentIDs,b.parentCommentID,b.viewas);break}return a},b)||babelHelpers.assertThisInitialized(d)}var d=b.prototype;d.getInitialState=function(){return{}};d.areEqual=function(a,b){return Object.keys(a).length===Object.keys(b).length};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFIUnseenCommentsStore",["FluxReduceStore","UFIComments","UFIConstants","UFIDispatcherBase"],(function(a,b,c,d,e,f,g){"use strict";var h=30;a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=c=a.call.apply(a,[this].concat(f))||this,c.reduce=function(a,b){switch(b.type){case"set_comments_scroll_distance":var e=b.instanceID,f=b.scrollDist,g=c.getInstanceState(e);g=babelHelpers["extends"]({},g,{scrollDist:f});c.shouldAddUnseenCommentsForState(g)||(g.unseenComments=0,g.unseenCommentsByThread={});return babelHelpers["extends"]({},a,(f={},f[e]=g,f));case"set_comment_reactions_menu_shown":var h;e=b.instanceID;g=b.commentReactionsMenuShown;f=c.getInstanceState(e);return babelHelpers["extends"]({},a,(h={},h[e]=babelHelpers["extends"]({},f,{commentReactionsMenuShown:g}),h));case"handle_new_comments":e=b.instanceID;f=b.numComments;if(!c.shouldAddUnseenComments(e))return a;g=c.getInstanceState(e);return babelHelpers["extends"]({},a,(h={},h[e]=babelHelpers["extends"]({},g,{unseenComments:g.unseenComments+f}),h));case"handle_new_facecast_reply":e=b.instanceID;g=d("UFIComments").getComment(b.replyCommentID);if(!c.shouldAddUnseenComments(e)||!g)return a;f=c.getInstanceState(e);h=f.unseenCommentsByThread;b=g.parentcommentid;if(b)h[b]=h[b]||0,h[b]++;else return a;return babelHelpers["extends"]({},a,(g={},g[e]=babelHelpers["extends"]({},f,{unseenCommentsByThread:h}),g));default:return a}},b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.getInitialState=function(){return{}};c.getInstanceState=function(a){a=this.getState()[a];return a||{commentsReactionMenuShown:!1,scrollDist:0,unseenComments:0,unseenCommentsByThread:{}}};c.getCommentReactionsMenuShown=function(a){return this.getInstanceState(a).commentReactionsMenuShown};c.getScrolledUp=function(a){return this.getScrollDist(a)>d("UFIConstants").maxScrollDistanceForAutoScroll};c.getScrollDist=function(a){return this.getInstanceState(a).scrollDist};c.getUnseenComments=function(a){return this.getInstanceState(a).unseenComments};c.getUnseenCommentsByThread=function(a){return this.getInstanceState(a).unseenCommentsByThread};c.getUnseenCommentsInThread=function(a,b){a=this.getUnseenCommentsByThread(a);return a[b]||0};c.shouldAddUnseenComments=function(a){return this.shouldAddUnseenCommentsForState(this.getInstanceState(a))};c.shouldAddUnseenCommentsForState=function(a){return a.scrollDist>d("UFIConstants").maxScrollDistanceForAutoScroll||a.commentReactionsMenuShown&&a.scrollDist>=h};return b}(c("FluxReduceStore"));a.__moduleID=f.id;b=new a(c("UFIDispatcherBase"));g["default"]=b}),98);
__d("UFINewCommentsPillUtils",["UFISharedDispatcher","UFIStoryAction","UFIUnseenCommentsStore"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=a?a.length:0,d=b?b.length:0;if(!c&&!d)return 0;var e,f=0;if(a)for(var c=c-1;c>=0;c--){var g=a[c];if(g.__typename==="saved"){e=g.id;break}f++}g=0;c=!1;if(b)for(var a=d-1;a>=0;a--){d=b[a];if(d.id===e){c=!0;break}g++}d=g-f;if(!e||c)return d;else return 0}function b(a,b){b=b.target;b instanceof HTMLElement&&h(b,a)}function h(a,b){a=a.scrollHeight-a.offsetHeight-a.scrollTop;c("UFISharedDispatcher").dispatch(d("UFIStoryAction").setCommentsScrollDistance(b,a))}function e(a,b){if(a&&b){var c=a.scrollHeight-a.offsetHeight;b=b.Animation;new b(a).to("scrollTop",c).ease(b.ease.end).duration(Math.min(400,Math.max(200,(c-a.scrollTop)/1.5))).ondone(function(){a.scrollTop=a.scrollHeight-a.offsetHeight}).go()}}function f(a,b){a.type==="handle_new_facecast_reply"&&c("UFISharedDispatcher").dispatch(d("UFIStoryAction").addFacecastReply(b,a.replyCommentID));b=b.instanceid;!c("UFIUnseenCommentsStore").getScrolledUp(b)&&c("UFIUnseenCommentsStore").getCommentReactionsMenuShown(b)?setTimeout(function(){c("UFISharedDispatcher").dispatch(a)},0):c("UFISharedDispatcher").dispatch(a)}g.findNumNewComments=a;g.handleScroll=b;g.updateScrolledUp=h;g.scrollToBottom=e;g.dispatchNewCommentAction=f}),98);